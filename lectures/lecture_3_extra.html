<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MT611 - Quantitative Research Methods</title>
    <meta charset="utf-8" />
    <meta name="author" content="Damien Dupré" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/custom_design.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# MT611 - Quantitative Research Methods
## Lecture 3: Understanding the General Linear Model
### Damien Dupré
### Dublin City University

---




class: inverse, mline, center, middle

# Power Analysis for Sample Size and Effect Size Estimations

---

# Theoretical Principle

Remember, the null hypothesis `\(H_0\)` is the hypothesis that a difference does not exist between the groups in the overall population. If the null hypothesis is rejected, we accept the alternative hypothesis `\(H_a\)` that a difference does exist between the groups in the population.

This means that four possible situations can occur when we run hypothesis tests:

- We reject `\(H_0\)`...
  - and in fact `\(H_a\)` is true. This is a good outcome and one which is most often the motivation for the hypothesis test in the first place.
  - but in fact `\(H_a\)` is false. This is known as a **Type I error**.

- We fail to reject `\(H_0\)`...
  - and in fact `\(H_a\)` is false. This is a good outcome.
  - but in fact `\(H_a\)` is true. This is known as a **Type II error**.

&gt; Statistical power refers to the fourth situation and is the probability that we are able to detect the effect that we are looking for.

---

# Theoretical Principle

&lt;img src="https://learning.eupati.eu/pluginfile.php/673/mod_book/chapter/388/eupati-types1-2-errors.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# Statistical Power

The ability to identify an effect if it exists (i.e., statistical power) depends at a minimum on three criteria:

- The significance level `\(\alpha\)` to reject `\(H_0\)` (usually `\(\alpha\)` is set at 0.05 or 5%)
- The size `\(n\)` of the sample being used
- The proportion of the variability of the Outcome variable explained by all the Predictors (i.e., full model), known as the **effect size**

The minimum level of statistical power to achieve is usually set at least 0.8 or 80% (i.e., we want at least a 80% probability that the test will return an accurate rejection of `\(H_0\)`).

- If all the criteria are known except `\(n\)`, then it is possible to approximate the `\(n\)` necessary to obtain at least a 0.8 or 80% power to correctly reject `\(H_0\)` before running the analysis (**prospective power analysis**).

- It is also possible to evaluate which has been achieved once the analysis has been done (**retrospective power analysis**).

---
class: title-slide, middle

## Sample Size Estimation with Prospective Power Analysis

---

# Sample Size Estimation

The main question of most researchers is "how many participant is enough to test the formulated hypotheses?"

While some would obtain an approximate answer from their colleagues such as "at least 100" or "at least 50 per groups", there is an actual exact answer provided by the power analysis:

&gt; "It depends how big is the effect size"

Prospective Power Analysis is reported in the Method section of research papers in order to describe how the sample size has been estimated thanks to an approximated effect size at the model level (e.g., small, medium, or large)

---

# Sample Size Estimation

The values of the approximated effect size depend on the type of model tested:

- A model with 1 Main Effect of a Categorical Predictor with 2 categories uses Cohen's `\(d\)`
- All other models including Main and Interaction Effect involving Categorical Predictor with 3+ categories or Continuous Predictor uses Cohen's `\(f\)` 

Note: A model with only Main Effects of Continuous Predictors can use a `\(f\)` or `\(f^2\)`

Effect Size Rule of Thumb:

|Effect Size | Small| Medium| Large|
|:-----------|-----:|------:|-----:|
|$d$         |  0.20|   0.50|  0.80|
|$f$         |  0.10|   0.25|  0.40|
|$f^2$       |  0.02|   0.15|  0.35|

---

# Sample Size Estimation

Power analyses using Cohen's `\(f\)` effect size (i.e., all model expect the ones using a Cohen's `\(d\)`) are calculated with an additional parameter: **Numerator df** (degree of freedom)

The degree of freedom of each effect is added to obtain the **Numerator df**:
  - In main effects
    - Continuous Predictors have 1 df
    - Categorical Predictors have k - 1 df (number of categories - 1)
  - In interaction effects, the df of the predictors involved are multiplied
  
Example:

`$$js\_score = b_{0} + b_{1}\,salary + b_{2}\,location + b_{3}\,salary*location + e$$`

- `\(b_{1}\,salary\)` has 1 df (Continuous Predictor)
- `\(b_{2}\,location\)` has 2 df (3 locations - 1)
- `\(b_{3}\,salary*location\)` has 2 df (1 * 2)

The model's **Numerator df** is 5 (1+2+2)

Note: The number of groups is usually the same as **Numerator df**

---

# Sample Size Estimation

There are multiple possibilities to perform a power analysis: 

- Websites hosted online such as http://powerandsamplesize.com or https://sample-size.net (but none are satisfying)
- Embedded in Statistical software such as SPSS or Jamovi (but none are satisfying)
- Specific software such as G*power (free and the most used power analysis software)
- Packages for coding languages (like {pwr} in R or `statsmodels` in python)

While the last option will be the best solution after being introduced to R, G*power is the most commonly used software and can be downloaded for free here:
https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower.html

---

# Sample Size Estimation

G*power uses 3 characteristics to determine the type of power analysis:
1. **Test family** (e.g., t-test for models with 1 predictor either continuous or having two categories or F-test for all other models)
2. **Statistical test** (e.g., mean comparison, ANOVA, multiple linear regression)
3. **Type of power analysis** (e.g., prospective also called "a priori" or retrospective also called "post hoc")

Whatever your model is, for Sample Size Estimation with Prospective Power Analysis use:
- **F-tests**
- **ANOVA: Fixed effects, special, main effects and interactions**
- **A priori: Compute required sample size - given `\(\alpha\)`, power, and effect size**

---

# Applied Example 1

Model Characteristics with `\(js\_score\)` as Continuous Outcome:
- 1 Main Effect of `\(gender\)` (Categorical Predictor with 2 categories: male and female employees)

Statistical  Power:
- Alpha of 0.05 (5%)
- Power of 0.8 (80% probability of accurately rejecting `\(H_0\)`)
- Effect size of `\(d = 0.5\)` (medium)

This tells us that we need an absolute minimum of 128 individuals in our sample (64 male and 64 female employees) for an effect size of `\(d = 0.5\)` to return a significant difference at an alpha of 0.05 with 80% probability.

---

# Applied Example 1

&lt;img src="img/gpower_exemple_1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Applied Example 1

&lt;img src="img/gpower_exemple_1_bis.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Applied Example 2

Model Characteristics with `\(js\_score\)` as Continuous Outcome:
- 1 Main Effect of `\(location\)` (Categorical Predictor with 3 categories: Irish, French, and Australian employees)

Statistical  Power
- Alpha of 0.05 (5%)
- Power of 0.8 (80% probability of accurately rejecting `\(H_0\)`)
- Effect size of `\(f = 0.25\)` (medium)

This tells us that we need an absolute minimum of 158 individuals in our sample for an effect size of `\(f = 0.25\)` to return a significant difference at an alpha of 0.05 with 80% probability.

---

# Applied Example 2

&lt;img src="img/gpower_exemple_2.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Applied Example 3

Model Characteristics with `\(js\_score\)` as Continuous Outcome:
- 1 Main Effect of `\(location\)` (Categorical Predictor with 3 categories: Irish, French, and Australian employees)
- 1 Main Effect of `\(salary\)` (Continuous Predictor)
- 1 Interaction Effect of `\(location\)` and `\(salary\)`

Statistical  Power
- Alpha of 0.05 (5%)
- Power of 0.8 (80% probability of accurately rejecting `\(H_0\)`)
- Effect size of `\(f = 0.25\)` (medium)

This tells us that we need an absolute minimum of 211 individuals in our sample for an effect size of `\(f = 0.25\)` to return a significant difference at an alpha of 0.05 with 80% probability.

---

# Applied Example 3

&lt;img src="img/gpower_exemple_3.png" width="100%" style="display: block; margin: auto;" /&gt;

---
class: title-slide, middle

## Effect Size Estimation with Retrospective Power Analysis

---

# Effect Size Reporting

Reporting effect size for each estimate (each hypothesis) in the Result section is the norm

With the General Linear Model, the effect size of each estimate is the corresponding standardised estimate `\(\beta\)`. Therefore, no other information needs to be reported.

However, you will see a lot of different metrics in research papers using different statistical tests for their hypotheses. Here is a list of the most used:
- Cohen's `\(d\)` for a Main Effect in a model with 1 Categorical Predictor with 2 categories
- Eta-squared `\(\eta^2\)` or partial Eta-squared `\(\eta^2_p\)` for all the other models

Notes:
- The `\(\eta^2_p\)` for a particular estimate corresponds to the effect size when the other effects in the model are deliberately ignored.
- Both `\(\omega^2\)` and `\(\epsilon^2\)` (and their partial counterparts, `\(\omega^2_p\)` and `\(\epsilon^2_p\)`) are unbiased estimators of the population’s `\(\eta^2\)` (or `\(\eta^2_p\)`, respectively), which is especially important is small samples.
- `\(\eta^2_p\)` aims at estimating the effect size in a design where all the variables have been experimentally manipulated (e.g., experimental groups). However, some predictors can only be observed. For such cases, we can use generalized Eta squared `\(\eta^2_G\)`.

---
class: inverse, mline, left, middle

&lt;img class="circle" src="https://github.com/damien-dupre.png" width="250px"/&gt;

# Thanks for your attention and don't hesitate if you have any question!

[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> @damien_dupre](http://twitter.com/damien_dupre)  
[<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> @damien-dupre](http://github.com/damien-dupre)  
[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg> damien-datasci-blog.netlify.app](https://damien-datasci-blog.netlify.app)  
[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg> damien.dupre@dcu.ie](mailto:damien.dupre@dcu.ie)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="libs/cols_macro.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "zenburn",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
