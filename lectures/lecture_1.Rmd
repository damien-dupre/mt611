---
title: "MT611 - Quantitative Research Methods"
subtitle: "Lecture 1: Variables, Models, Hypotheses and Equations"
author: "Damien Dupré"
date: "Dublin City University"
output:
  xaringan::moon_reader:
    css: ["default", "metropolis", "metropolis-fonts", "css/custom_design.css"]
    lib_dir: libs
    nature:
      beforeInit: "libs/cols_macro.js"
      highlightStyle: zenburn
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include = FALSE}
# general options --------------------------------------------------------------
options(scipen = 999)
set.seed(123)
# chunk options ----------------------------------------------------------------
knitr::opts_chunk$set(
  cache.extra = knitr::rand_seed, 
  message = FALSE, 
  warning = FALSE, 
  error = FALSE, 
  echo = FALSE,
  cache = FALSE,
  comment = "", 
  fig.align = "center", 
  fig.retina = 3
  )
# libraries --------------------------------------------------------------------
library(tidyverse)
library(nomnoml)
library(DiagrammeR)
library(ggrepel)
library(fontawesome)
```

# Why Statistics?

Ask to yourself: *"Why do you do statistics? Why don't scientists just use common sense?"*

The best answer is a really simple one: **we don't trust ourselves enough**
 - Much of statistics is basically a safeguard

Scientific reasoning  requires to engage in **induction**, making wise guesses and going beyond the immediate evidence of the senses to make generalisations about the world.

Scientists can't solve **deductive** problems (ones where no guessing is required) without being influenced by pre-existing biases.

---

# Deductive vs. Inductive Research

**Deductive research** is 
- the process of deduce explanations from the results without formulating hypotheses before their analysis
- also called HARKing (hypothesizing after the results are known)

**Inductive research** is
- the process of formulating hypotheses a priori from theories and to test them against the data

Every hypothesis has to state a difference (between groups or according values) also called $H_a$ (for alternative hypothesis) or $H_1$

Every hypothesis has a null hypothesis counterpart (no difference between groups or according values) also called $H_0$ (pronounce H naught or H zero)
  
**Testing hypotheses consists in evaluating the chance of having "the difference obtained in my sample" knowing that the null hypothesis is true in the real life.**

---

# Concept Relationships

```{nomnoml, fig.width=12, fig.height=3}
#stroke: black
#direction: right
#align: center
[Variables]->[Model]
[Model]->[Hypotheses]
[Hypotheses]->[Equation]
```

---
class: inverse, mline, center, middle

# 1. Variables

---

# What is a Variable?

A variable itself is a subtle concept, but basically it comes down to finding some way of **assigning numbers or characters to labels**.

- **My age is** *36 years*.
- *I do* **like anchovies**.
- My **chromosomal gender is** *male*.
- My **self-identified gender is** *male*.

The bold part is "the thing that varies", and the italicised part is "the value of the variable".

---

# What is a variable?

- My **age** (in years) could have been *0, 1, 2, 3 ... *, etc. 

- When asked if I **like anchovies**, I might have said that *I do*, or *I do not*, or *I have no opinion*, or *I sometimes do*.

- My **chromosomal gender** is almost certainly going to be *male* or *female*.

- My **self-identified gender** is also very likely to be male or female, but it doesn't have to agree with my chromosomal gender.

---

# Operationalisation

Operationalisation is the process of selecting a vague concept and turn it into a variable

**Be precise about what you are trying to measure/compare**
- For instance, does "age" mean "time since birth" or "time since conception" in the context of your research?

**Determine what method you will use to measure/compare it**
- Will you use self-report to measure age, ask a parent, or look up an official record? If you're using self-report, how will you phrase the question?

**Define the set of allowable values that the variable can take**
- These values don't always have to be numerical, though they often are.

---

# Categories of Variable

Variables can have different types:

- **Categorical**: If the variable's possibilities are words or sentences (character string)
  - if the possibilities cannot be ordered: Categorical Nominal (*e.g.*, gender)
  - if the possibilities can be ordered: Categorical Ordinal (*e.g.*, opinion from disagree to agree)
- **Continuous**: If the variable's possibilities are numbers
  - if it starts from 0: Continuous Ratio (*e.g.*, age)
  - if it it goes below 0: Continuous Interval (*e.g.*, temperature) 

Variables can be converted to either Categorical and Continuous but it is always better to keep them in their correct scale.
- Example, Likert item (Opinion question from disagree to agree) are Categorical Ordinal but are analysed as Continuous.

---
# Latent Variables

Questionnaires/survey are made of multiple questions (also called items)

Some questions are related the the measurement of a same theoretical construct called Latent Variable. In this case all the items are making the scale measuring the Latent Variable.

To be analysed a scale has some requirements:

1. all the items must have the same range of possibilities/modalities
2. all the items must correlate together (scale reliability)
3. a unique theoretical construct score has to be calculated from all the items even if it contains subscales.

There are two way to obtain the Latent Variable: Average of all items (reversed if necessary) or Factor/Component analysis

---

# Latent Variables

Example:

"Perceived Ease-of-use" of Microsoft Excel scale:
- Q1/ I think learning to use Microsoft Excel is easy
- Q2/ I think finding what I want via Microsoft Excel is easy
- Q3/ I think becoming skilful at using Microsoft Excel is easy
- Q4/ I think using Microsoft Excel is easy

```{r}
DiagrammeR::grViz("
digraph rmarkdown {
  graph [rankdir = RL]
  
  node [shape = oval]
  'Perceived Ease-of-use'
  
  node [shape = box]
  Q1; Q2; Q3; Q4
  
  'Perceived Ease-of-use'-> {Q1 Q2 Q3 Q4}   

}
", height = 200)
```

---

# Validity and Reliability

**Validity = is my variable measuring the construct that I think I am measuring?**
- Face validity. Does the measurement make sense on its face? 
- Construct validity. Is the measurement related to other measurements in an appropriate way?
- Predictive validity. Is the measurement predicting related constructs?

Validity assessment is only performed when a measurement is created (no need for existing scales)

**Reliability = consistency of items inside a measurement**
- Test-retest reliability
- Inter-rater reliability
- Correlation inter-item (Cronbach's alpha)

Reliability assessment is performed every time a scale is used (Cronbach's alpha)

---

# Validity and Reliability

```{r out.width = "50%"}
knitr::include_graphics("https://www.publichealthnotes.com/wp-content/uploads/2018/08/560px-Reliability_and_validity.svg_.png")
```

---

# Predictors, Outcomes and Controls

It's important to keep the two roles "variable doing the explaining" and "variable being explained" distinct.

Let's denote the:
 - Outcome: "to be explained" variable as Y (also called Dependent Variable or DV)
 - Predictor: "doing the explaining" as X (also called Independent Variable or IV)
 
---

# Predictors, Outcomes and Controls

This results in the following equation: $Y = X$ 

Which can be translated by the following hypotheses:
- "the variable Y is explained by the variable X"
- "the variable X is explaining the variable Y"
- "the variable X influences the variable Y"
- "there is a link/relationship between X and Y"

Note, despite having different formulation, they are all the same.

Which corresponds to the following model:

```{nomnoml, fig.width=12, fig.height=3}
#stroke: black
#direction: right
#align: center

[X]->[Y]
```

---

# Predictors, Outcomes and Controls

Be careful, in the order of predictor and outcome is different according to the model, hypotheses and equations:

- In a model, the Predictors are first then comes the Outcome

```{nomnoml, fig.width=12, fig.height=1}
#stroke: black
#direction: right
#align: center

[X]->[Y]
```

- In an equation, the Outcome is first then comes the Predictors

.center[ Y = X ]

- In an hypothesis, the order depends on the formulation

  - "the variable Y is explained by the variable X"
  - "the variable X is explaining the variable Y"
  - "the variable X influences the variable Y"
  - "there is a link/relationship between X and Y"
  
---

# Predictors, Outcomes and Controls

The only difference for control variables is that they are not included in the model and in the hypotheses but they are in the equation.

They are used to remove an irrelevant explanation of the variable changes.

---
class: title-slide, middle

## Exercise

In the research paper you have selected, identify the variables and their type (10min)

---
class: inverse, mline, center, middle

# 2. Model

---

# Structure of Models

In a model, **an arrow is an effect**

Example:

```{r eval=TRUE}
DiagrammeR::grViz("
digraph rmarkdown {
  graph [rankdir = LR]
  
  node [shape = oval]
  'Intention to Use'
  
  node [shape = box]
  'Actual Use'
        
  'Intention to Use' -> 'Actual Use'
}
", height = 200)
```

can be read as "Intention to Use has an effect on Actual Use".

---

# Structure of Models

Models are graphical representations of theories that highlight hypotheses:
- all the relations correspond to an hypothesis to be tested
- all the tested hypotheses have to be in the model

Distinguish square and circles
- **squares** are actual **measures/items**
- **circles** are **latent variables** related to measures/items

Example:
- *Actual Use* is directly measured (time spend in min) so it's a square.
- *Perceived Usefulness* is a latent variable with several questions so it's a circle.

Items used for latent variables can be omitted in a model, variables are the most important.

We can distinguish 2 types of relationship in a model:
- Main effect relationship
- Interaction effect relationship

---

# Main Effect Relationship

.pull-left[
The relation between one variable and another:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
    node [shape = circle]
    
    X -> Y
  }", height = 200, width = 200)
```

can be read as:
- "X has a **main** effect on Y"
]
.pull-right[
A model can have multiple main effects: 

```{r eval=TRUE}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
    node [shape = circle]
    
    X -> Y
    Z -> Y
  }", height = 200, width = 200)
```

can be read as: 
- "X has a **main** effect on Y"
- "Z has a **main** effect on Y"
]

---

# Interaction Effect Relationship

The relation between two predictor variables and another outcome variable. An interaction means that **the effect of X on Y will be different according the possibilities of Z** (also called Moderation).

.pull-left[
classic representation:
```{r eval=TRUE}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node [shape = circle]
    X; Y; Z
    node [shape = point, width = 0, height = 0]
    ''
    
    Z -> ''
    X -> '' [arrowhead = none]
    ''-> Y
    
    subgraph {
      rank = same; Z; '';
    }
  }", height = 200, width = 300)
```
]

.pull-right[
is the same as:
```{r eval=TRUE}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
    node [shape = circle]
    
    X -> Y
    Z -> Y
    'X*Z' -> Y
  }", height = 200, width = 200)
```
]

The arrow crossing the main effect arrow can be read as :
- "X have a **main** effect on Y"
- "Z have a **main** effect on Y"
- "X and Z have an **interaction** effect on Y"

---

# Model's Constraints

1. Every model is made of one or multiple main effect and/or interaction effect relationships

2. Control variables are not included in models

---

# Types of Model

## Simple Model

- One or more predictors
- Only one outcome
- Made of main or/and interaction effects

## Mediation Model (simple or moderated)

- At least 2 predictors (one call Mediator)
- Only one outcome
- Made of main effects only for simple mediation / main and interaction effects for moderated mediation

## Structural Equation Model (SEM)

- At least 2 predictors (usually latent variables)
- One or more outcome
- Made of main or/and interaction effects

---

# Simple Model

Simple Models are the most statistically powerful, easy to test and reliable models. Always prefer a simple model compared to a more complicated solution.

Warning, including interaction effect requires a significantly higher sample size (see calculation of power/effect size).

Example:

```{r eval=TRUE}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node [shape = circle]
    'Salary'; 'Job Satisfaction'; 'Gender'; 'Holidays'
    node [shape = point, width = 0, height = 0]
    ''
    
    'Holidays' -> 'Job Satisfaction'
    'Gender' -> ''
    'Salary' -> '' [arrowhead = none]
    '' -> 'Job Satisfaction'
    
    subgraph {
      rank = same; 'Gender'; '';
    }
    subgraph {
      rank = same; 'Holidays'; 'Salary';
    }
  }", height = 200, width = 300)
```

---

# Mediation Models

A Mediation model is a complex path analysis between 3 variables, where one of them explains the relationship between the other two. It is usually used to identify cognitive process in psychology.

Example:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node []
    'self-esteem'; 'math exam results'; happiness
    
    'math exam results' -> {happiness 'self-esteem'}
    'self-esteem' -> happiness

  }", height = 200)
```

---

# Structural Equation Model

A Structural Equation Model (SEM) is a complex path analysis between multiple variables including multiple Outcomes and using factor analysis for latent variable estimation.

```{r eval=TRUE}
DiagrammeR::grViz("
digraph rmarkdown {
  graph [rankdir = LR]
  
  node [shape = oval]
  'Perceived Ease-of-use'; 'Perceived Usefulness'; 'Intention to Use'; 'Actual Use'
  
  node [shape = box]
  PU1; PU2; PU3; PU4; PU5; PEOU1; PEOU2; PEOU3; PEOU4; BI1; BI2; AU
  
  {PU1 PU2 PU3 PU4 PU5} -> 'Perceived Usefulness' [arrowhead = none]
  {PEOU1 PEOU2 PEOU3 PEOU4} -> 'Perceived Ease-of-use' [arrowhead = none]
  {BI1 BI2} -> 'Intention to Use' [arrowhead = none]
  {AU} -> 'Actual Use' [arrowhead = none]
  
  'Perceived Usefulness' -> 'Intention to Use'
  'Perceived Ease-of-use' -> {'Perceived Usefulness' 'Intention to Use'}
  'Intention to Use' -> 'Actual Use'
  
  subgraph {
      rank = same; 'Perceived Usefulness'; 'Perceived Ease-of-use';
  }
  
  subgraph {
      rank = same; PU1; PU2; PU3; PU4; PU5; PEOU1; PEOU2; PEOU3; PEOU4; BI1; BI2;
  }

}
", height = 400)
```

---

# A Good Model

- Comprehensiveness: Explains a wide range of phenomena
- Internal Consistency: Propositions and assumptions are consistent and fit together in a coherent manner
- Parsimony: Contains only those concepts and assumptions essential for the explanation of a phenomenon
- Testability: Concepts and relational statements are precise.
- Empirical Validity: Holds up when tested in the real world.

Example: 

```{r eval=TRUE}
DiagrammeR::grViz("
digraph rmarkdown {
  graph [rankdir = LR]
  
  node [shape = oval]
  'Perceived Ease-of-use'; 'Perceived Usefulness'; 'Intention to Use'
  
  node [shape = box]
  'Actual Use'
  
  'Perceived Usefulness' -> 'Intention to Use'
  'Perceived Ease-of-use' -> {'Perceived Usefulness' 'Intention to Use'}
  'Intention to Use' -> 'Actual Use'
  
  subgraph {
      rank = same; 'Perceived Usefulness'; 'Perceived Ease-of-use';
  }
}
", height = 100)
```

---

# A bad Theory/Model

- too complicated
- does not explain many things
- cannot be tested

Is it bad?

![](https://d3i71xaburhd42.cloudfront.net/2a3e4a3024bfc4df27db07a1d48f77a6f371b0c3/8-Figure1-1.png)

---
class: title-slide, middle

## Exercise

In the research paper you have selected, draw the model(s) tested (10min)

---
class: inverse, mline, center, middle

# 3. Hypotheses

---

# Model and Hypotheses

Model: Overview of the predicted relationship between variables

Hypotheses:
- Predictions supported by theory/literature
- Tested to confirm or refute
- Can be revised or abandoned

Hypotheses are affirmations designed to precisely describe the predicted relationships between variables. 

*“Hypothesis statements contain two or more variables that are measurable or potentially measurable and that specify how the variables are related”* (Kerlinger, 1986)

---

# Hypothesis Testing

A hypothesis test consists of a test between two competing hypotheses:

- A null hypothesis $H_0$ (pronounced “H-naught”) versus
- An alternative hypothesis $H_a$ (also denoted $H_1$)

Generally the null hypothesis is a claim that there is “no effect” or “no difference of interest”. In many cases, the null hypothesis represents the status quo or a situation that nothing interesting is happening. Furthermore, generally the alternative hypothesis is the claim the experimenter or researcher wants to establish or find evidence to support. It is viewed as a “challenger” hypothesis to the null hypothesis $H_0$.

Testing hypotheses consists in evaluating the probability of having "the difference obtained in my sample" knowing that the null hypothesis is true in the real life.

---

# Formulating Hypotheses

Hypotheses include

- Predictor(s) / Independent Variable(s)
- Outcome / Dependent Variable (DV)
- Effect strength and direction
 - different is called two-tailed or two-sided
 - higher/lower is called one-tailed or one-sided

![](https://www.simplypsychology.org/controlled-experiment.jpg)

---

# Effect Strength and Direction

A comparative word in hypotheses:

- Different
- Bigger/Higher/Better *vs.* Smaller/Lower/Worst
- Increase *vs.* Decrease

The letter $\beta$ in equations

Hypothesis cannot test equality between groups or modalities

Hypothesis can only test differences

---

# Main Effect Hypothesis

Replace with yours:

- if IV is Categorical and DV is Categorical or Continuous

{**IV Condition1**} is {**>or<**} on {**DV**} than {**IV Condition2**}

- if IV is Continuous and DV is Categorical or Continuous

The {**DV**} {**increase or decrease**} when {**IV**} {**increase or decrease**}

---

# Main Effect Hypothesis Examples

Variables:
- DV = math exam results (continuous from 0 to 100)
- IV = breakfast (categorical *yes* or *no*)

--

Model:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
    
    'breakfast' -> 'math exam results'
  }", height = 200)
```

--

Hypothesis:

- Students who eat breakfast will perform better on a math exam than students who do not eat breakfast

---

# Main Effect Hypothesis Examples

Variables:
- DV = driving errors (continuous from 0 to Inf.)
- IV = motorists talking on the phone (categorical *yes* or *no*)

--

Model:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
    
    'motorists talking on the phone' -> 'driving errors'
  }", height = 200)
```

--

Hypothesis:

- Motorists who talk on the phone while driving will be more likely to make errors on a driving course than those who do not talk on the phone

---

# Main Effect Hypothesis Examples

Variables:
- DV = math exam results (continuous from 0 to 100)
- IV = students’ sleep time (continuous from 0h to 24h)

--

Model:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
    
    'students’ sleep time' -> 'math exam results'
  }", height = 200)
```

--

Hypothesis:

- The results on a math exam increase when students’ sleep time increase

---

# Interaction Effect Hypothesis

Replace with yours:

- if IV1 is Categorical, IV2 is Categorical or Continuous and DV is Categorical or Continuous

The effect of {**IV2**} on {**DV**} is {**>or<**} for {**IV1 Condition1**} than for {**IV1 Condition2**}

- if IV1 is Continuous, IV2 is Categorical or Continuous and DV is Categorical or Continuous

The effect of {**IV2**} on {**DV**} is {**>or<**} when {**IV1**} {**increase or decrease**}

---

# Interaction Effect Hypothesis Examples

Variables:
- DV = math exam results (continuous from 0 to 100)
- IV1 = gender (categorical male vs. female)
- IV2 = sleep deprivation (categorical low, medium, high)

--

Model:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node []
    'sleep deprivation'; 'math exam results'; gender
    node [shape = point, width = 0, height = 0]
    ''
    
    gender -> ''
    'sleep deprivation' -> '' [arrowhead = none]
    ''-> 'math exam results'
    
    subgraph {
      rank = same; gender; '';
    }
  }", height = 200)
```

--

Hypothesis:

- The effect of sleep deprivation on Math scores is higher for Males than for Females

---

# Interaction Effect Hypothesis Examples

Variables:
- DV = road accidents (continuous from 0 to Inf.)
- IV1 = alcohol consumption (continuous from 0L to Inf.L)
- IV2 = driving experience (categorical low, high)

--

Model:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node []
    'alcohol consumption'; 'road accidents'; 'driving experience'
    node [shape = point, width = 0, height = 0]
    ''
    
    'driving experience' -> ''
    'alcohol consumption' -> '' [arrowhead = none]
    ''-> 'road accidents'
    
    subgraph {
      rank = same; 'driving experience' ; '';
    }
  }", height = 200)
```

--

Hypothesis:

- The effect of alcohol consumption is higher on road accidents is lower for experienced drivers than for inexperienced drivers

---

# Mediation Effect Hypothesis

```{r eval=TRUE}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node [shape = circle]
    Z; X; Y
    
    X -> {Y Z}
    Z -> Y

  }", height = 200)
```

can be read as: 
- "the main effect of X on Y is explained by Z"

Warning, it involves 3 requirements:
- "X have a **main** effect on Y"
- "X have a **main** effect on Z"
- "the **main** effect of X on Y **disappears** when Z is taken into account"

Replace with yours:

The effect of {**IV1**} on {**DV**} is mediated by {**IV2/Med**}

---

# Mediation Effect Hypothesis Example

Variables:
- DV = happiness (continuous from 0 to 7)
- IV1 = math exam results (continuous from 0 to 100)
- IV2 = self-esteem (continuous from 0 to 7)

--

Model:

```{r eval=TRUE, fig.align="left"}
DiagrammeR::grViz("
  digraph {
    graph [rankdir = LR]
  
    node []
    'self-esteem'; 'math exam results'; happiness
    
    'math exam results' -> {happiness 'self-esteem'}
    'self-esteem' -> happiness

  }", height = 200)
```

--

Hypothesis:
- the effect of math exam results on happiness is mediated by self-esteem

---

# Example of Hypotheses in Research Papers

```{r out.width = "50%"}
knitr::include_graphics("img/ex1_title.png")
```

```{r out.width = "50%"}
knitr::include_graphics("img/ex1_hyp.png")
```
---

# Example of Hypotheses in Research Papers

```{r out.width = "50%"}
knitr::include_graphics("img/ex2_title.png")
```

```{r out.width = "50%"}
knitr::include_graphics("img/ex2_hyp1.png")
```

```{r out.width = "50%"}
knitr::include_graphics("img/ex2_hyp2.png")
```

---

# Find DVs and IVs in these Hypotheses

- Overweight adults who value longevity are more likely than other overweight adults to lose their excess weight

- Larger animals of the same species expend more energy than smaller animals of the same type.

- Rainbow trout suffer more lice when water levels are low than other trout.

- Professors who use a student-centered teaching method will have a greater positive rapport with their graduate students than professors who use a teacher-centered teaching method.

---

# Make your own Hypothesis

|DV|IV1|IV2|
|--|---|---|
|Work motivation|Gender(Female/Male)|/|
|Work motivation|Gender(Female/Male)|Origin(French/Irish)|
|Work motivation|Gender(Female/Male)|Origin(French/Irish/Italians)|
|Job Satisfaction|Stress(from 0 to 10)|/|
|Job Satisfaction|Stress(from 0 to 10)|Origin(French/Irish)|
|Job Satisfaction|Stress(from 0 to 10)|Age(Millennials/Baby boomers)|
|Job Satisfaction|Stress(from 0 to 10)|Age(in year)|

---

# A Hypothesis Checklist

- Does your hypothesis focus on something that you can actually test?
- Does your hypothesis include both an independent and dependent variable?
- Can you manipulate the variables?

---
class: title-slide, middle

## Exercise

In the research paper you have selected, identify or formulate the tested hypotheses (10min)

---
class: inverse, mline, center, middle

# 4. Equation

---

# What is a Correlation?

A correlation indicate the strength and direction of a relationship and uses the letter $\beta$

It has a value between 1 and -1
- 1 indicates a strong and positive relationship
- -1 indicates a strong and negative relationship
- 0 indicates no relationship

---

# What is a Correlation?

```{r out.width = "70%"}
knitr::include_graphics("img/correlation.png")
```

---

# Evaluation of the Significance

Once all the hypotheses are formulated, it is time to test all of them in one unique model. In this model, a value called $\beta$ which is usually the coefficient of correlation is associated to each predictor from the hypotheses. 

Testing for the significance of the effect means evaluating if this $\beta$ value is significantly different, higher or lower than 0 (no link between variables):

$H_a: \beta \neq 0$ or $\beta > 0$ or $\beta < 0$

$H_0: \beta = 0$

---

# A Basic Equation

The equation $Y = X$ involves that the variable Y is completely explained by the variable X.

.pull-left[
```{r, eval=TRUE}
knitr::kable(data.frame(X = 1:10, Y = 1:10), format = "html")
```
]
.pull-right[
```{r eval=TRUE, fig.height=5}
data.frame(X = 0:10, Y = 0:10) %>% 
  ggplot(aes(X, Y)) +
  geom_point(color = "black", size = 5) +
  geom_smooth(method = "lm") +
  scale_x_continuous(limits = c(0,10)) +
  scale_y_continuous(limits = c(0,10)) +
  theme_bw()
```
]

---

# A Basic Equation

In the equation $Y = X$, three coefficients are hidden because they are unused:
- the intercept coefficient $\beta_{0}$ corresponds to the value of Y when X = 0
    - which is O in our case
- the slope coefficient $\beta_{1}$ corresponds to how much Y increase when X increase of 1
    - which is 1 in our case
- the error coefficient $\epsilon$ corresponds to how far from the prediction line the values of Y are
    - which is 0 in our case

So in general, the relation between a predictor and an outcome can be written as:
$$Y = \beta_{0} + \beta_{1} . X + \epsilon$$

which is in our case:

$$Y = 0 + 1 * X + 0$$

---

# A Basic Equation

The equation $Y = \beta_{0} + \beta_{1}.X + \epsilon$ is the same as the good old $y = ax + b$ (here ordered as $y = b + ax$) where $\beta_{0}$ is $b$ and $\beta_{1}$ is $a$.

It is very important to know that under **EVERY** statistical test, a similar equation is used (t-test, ANOVA, Chi-square are all linear regressions)

---

# Basic Example

.pull-left[
```{r, eval=TRUE}
knitr::kable(data.frame(
  participant = c("ppt1", "ppt2", "ppt3", "ppt4", "ppt5", "ppt6"), 
  IQ = c(120, 103, 96, 87, 114, 95),
  math_results = c(89, 64, 71, 77, 78, 69)
  ), 
  format = "html")
```
]
.pull-right[
```{r eval=TRUE, fig.height=5}
data.frame(
  participant = c("ppt1", "ppt2", "ppt3", "ppt4", "ppt5", "ppt6"), 
  IQ = c(120, 103, 96, 87, 114, 95),
  math_results = c(89, 64, 71, 77, 78, 69)
  ) %>% 
  ggplot(aes(x = IQ, y = math_results, label = participant)) +
  geom_point(color = "black", size = 5) +
  #geom_smooth(method = "lm") +
  geom_text_repel(point.padding = 0.5, size = 14) +
  theme_bw() +
  theme(
    text = element_text(size = 14)
  )
```
]

---

# Basic Example

Variables:
- DV = math results (from 0 to 100)
- IV = IQ (from 0 to Inf.)

Hypothesis (one-tailed):
- $H_a$: When IQ increases, math results increases as well (means $\beta_1$ > 0) 
- $H_0$ When IQ increases, math results stay the same (means $\beta_1$ = 0)

Equation:

$$MathResults = \beta_{0} + \beta_{1}.IQ + \epsilon$$

---

# More Examples (1)

.pull-left[
```{r, eval=TRUE}
df2 <- data.frame(
  participant = c("ppt1", "ppt2", "ppt3", "ppt4", "ppt5", "ppt6"), 
  gender = c("Female", "Male", "Male", "Female", "Male", "Female"),
  math_results = c(89, 64, 71, 77, 78, 69)
)

# write.csv(df2, "basic_example_2.csv", row.names = FALSE)

knitr::kable(df2, 
  format = "html")
```
]
.pull-right[
```{r eval=TRUE, fig.height=5}
df2 %>% 
  ggplot(aes(x = gender, y = math_results)) +
  geom_point(color = "black", size = 5) +
  stat_summary(fun.y = "mean", colour = "blue", size = 6, geom = "point") +
  theme_bw() +
  theme(
    text = element_text(size = 14)
  )
```
]

---

# More Examples (1)

Variables:
- DV = math results (from 0 to 100)
- IV = gender (female vs. male)

Hypothesis (one-tailed): 
- $H_a$: avg(female) > avg(male) means $\beta_1 > 0$
- $H_0$: avg(female) = avg(male) means $\beta_1 = 0$

Equation:

$$MathResults = \beta_{0} + \beta_{1}.gender + \epsilon$$

---

# More Examples (2)

.pull-left[
```{r, eval=TRUE}
df3 <- data.frame(
  participant = c("ppt1", "ppt2", "ppt3", "ppt4", "ppt5", "ppt6", "ppt7", "ppt8"), 
  age = c("0-29", "30-59", "60-89", "90-119", "0-29", "30-59", "60-89", "90-119"),
  math_results = c(89, 64, 71, 77, 78, 69, 59, 99)
)

# write.csv(df3, "basic_example_3.csv", row.names = FALSE)

knitr::kable(
  df3, 
  format = "html")
```
]
.pull-right[
```{r eval=TRUE, fig.height=5}
df3 %>% 
  ggplot(aes(x = age, y = math_results)) +
  geom_point(color = "black", size = 5) +
  stat_summary(fun.y = "mean", colour = "blue", size = 6, geom = "point") +
  theme_bw() +
  theme(
    text = element_text(size = 14)
  )
```
]

---

# More Examples (2)

Variables:
- DV = math results (from 0 to 100)
- IV = age group (0-29; 30-59; 60-89; 90-119)

Hypothesis (one-tailed): 
- $H_a$: When age increases, math results increases as well (means $\beta_1 > 0$)
- $H_0$: When age increases, math results stay the same (means $\beta_1 = 0$)

Equation:

$$MathResults = \beta_{0} + \beta_{1}.age + \epsilon$$

---

# Example with Interaction

.pull-left[
```{r, eval=TRUE}
df4 <- data.frame(
  participant = c("ppt1", "ppt2", "ppt3", "ppt4", "ppt5", "ppt6"), 
  IQ = c(120, 103, 96, 87, 114, 95),
  gender = c("Female", "Male", "Male", "Female", "Male", "Female"),
  math_results = c(89, 64, 71, 77, 52, 69)
)

# write.csv(df4, "basic_example_4.csv", row.names = FALSE)

knitr::kable(df4, 
  format = "html")
```
]
.pull-right[
```{r eval=TRUE, fig.height=5}
df4 %>% 
  ggplot(aes(x = IQ, y = math_results)) +
  geom_point(size = 5, aes(color = gender)) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_bw() +
  theme(
    text = element_text(size = 14)
  )
```
]

---

# Example with Interaction

Hypothesis (one-tailed): 
- $H_{a_{1}}$: When IQ increases, math results increases as well
- $H_{0_{1}}$: When IQ increases, math results stay the same

- $H_{a_{2}}$: math results of males are higher than math results of females
- $H_{0_{2}}$: math results of males are not different to math results of females

- $H_{a_{3}}$: the effect of gender on math results increase when IQ increases
- $H_{0_{3}}$: the effect of gender on math results stay the same when IQ increases

Equations:

$$MathResults = \beta_{0} + \beta_{1}.IQ + \beta_{2}.gender + \beta_{3}.interaction + \epsilon$$

which equals to:

$$MathResults = \beta_{0} + \beta_{1}.IQ + \beta_{2}.gender + \beta_{3}.IQ*gender + \epsilon$$

---

# More Examples with Interaction

.pull-left[
```{r, eval=TRUE}
df5 <- data.frame(
  participant = c("ppt1", "ppt2", "ppt3", "ppt4", "ppt5", "ppt6"), 
  IQ = c(120, 103, 96, 87, 114, 95),
  age = c(20, 25, 38, 34, 41, 45),
  math_results = c(89, 64, 71, 77, 52, 69)
)

# write.csv(df5, "basic_example_5.csv", row.names = FALSE)

knitr::kable(df5, 
  format = "html")
```
]
.pull-right[
```{r eval=TRUE, fig.height=5}
df5 %>% 
  ggplot(aes(x = IQ, y = math_results)) +
  geom_point(size = 5, aes(color = age)) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_bw() +
  theme(
    text = element_text(size = 14)
  )
```
]

---

# More Examples with Interaction

Hypothesis (one-tailed): 
- $H_{a_{1}}$: When IQ increases, math results increases as well
- $H_{0_{1}}$: When IQ increases, math results stay the same

- $H_{a_{2}}$: When age increases, math results increases as well
- $H_{0_{2}}$: When age increases, math results stay the same

- $H_{a_{3}}$: the effect of age on math results increase when IQ increases
- $H_{0_{3}}$: the effect of age on math results stay the same when IQ increases

Equations:

$$MathResults = \beta_{0} + \beta_{1}.IQ + \beta_{2}.age + \beta_{3}.interaction + \epsilon$$

which equals to:

$$MathResults = \beta_{0} + \beta_{1}.IQ + \beta_{2}.age + \beta_{3}.IQ*age + \epsilon$$

---

# Mediation Effect

The mediation model is a path analysis which involves 3 different linear models.

Let's take the example in https://data.library.virginia.edu/introduction-to-mediation-analysis/

Data analysis is also presented here: https://jamovi-amm.github.io/glm_example1.html

Data used for this example can be downloaded here: https://jamovi-amm.github.io/glm_example1.html
- X = grades
- Y = happiness
- M = self-esteem

---

# Mediation Effect

Imagine that previous studies have suggested that higher grades predict higher happiness: X (grades) → Y (happiness). This is called **Direct Effect**.

```{r eval=TRUE, out.width = '70%'}
knitr::include_graphics("https://data.library.virginia.edu/files/mediation_ex1.png")
```

However, grades are not the real reason that happiness increases. Let's hypothesize that good grades boost one’s self-esteem and then high self-esteem boosts one’s happiness: X (grades) → M (self-esteem) → Y (happiness). This is called **Indirect Effect**.

```{r eval=TRUE, out.width = '70%'}
knitr::include_graphics("https://data.library.virginia.edu/files/mediation_ex2.png")
```

Self-esteem is a mediator that explains the underlying mechanism of the relationship between grades (IV) and happiness (DV).

---

# How to Analyse Mediation Effects?

A mediation analysis is comprised of three sets of regression: X → Y, X → M, and X + M → Y. They are just three regression analyses!

## Step 1

```{r eval=TRUE, out.width = '70%'}
knitr::include_graphics("https://data.library.virginia.edu/files/mediation_step1.png")
```

$$Y = \beta_{0} + \beta_{1}.X + \epsilon$$

Is $\beta_1$ significant? We want X to affect Y (Direct Effect). If there is no relationship between X and Y, there is nothing to mediate.

---

# How to Analyse Mediation Effects?

## Step 2

```{r eval=TRUE, out.width = '70%'}
knitr::include_graphics("https://data.library.virginia.edu/files/mediation_step2.png")
```

$$M = \beta_{0} + \beta_{2}.X + \epsilon$$

Is $\beta_2$ significant? We want X to affect M. If X and M have no relationship, M is just a third variable that may or may not be associated with Y. A mediation makes sense only if X affects M.

---

# How to Analyse Mediation Effects?

## Step 3

```{r eval=TRUE, out.width = '70%'}
knitr::include_graphics("https://data.library.virginia.edu/files/mediation_step3.png")
```

$$Y = \beta_{0} + \beta_{4}.X + \beta_{3}.M + \epsilon$$

Is $\beta_4$ non-significant or smaller than before? We want M to affect Y, but X to no longer affect Y (or X to still affect Y but in a smaller magnitude). If a mediation effect exists, the effect of X on Y will disappear (or at least weaken) when M is included in the regression. The effect of X on Y goes through M.

If the effect of X on Y completely disappears, M fully mediates between X and Y (full mediation). If the effect of X on Y still exists, but in a smaller magnitude, M partially mediates between X and Y (partial mediation).

---

# How to Analyse SEM?

In SEM, there are as many equation as there are Outcomes/Dependent Variables.

For example, in the following model: 

```{r eval=TRUE}
DiagrammeR::grViz("
digraph rmarkdown {
  graph [rankdir = LR]
  
  node [shape = oval]
  'Perceived Ease-of-use'; 'Perceived Usefulness'; 'Intention to Use'
  
  node [shape = box]
  'Actual Use'
  
  'Perceived Usefulness' -> 'Intention to Use'
  'Perceived Ease-of-use' -> {'Perceived Usefulness' 'Intention to Use'}
  'Intention to Use' -> 'Actual Use'
  
  subgraph {
      rank = same; 'Perceived Usefulness'; 'Perceived Ease-of-use';
  }
}
", height = 100)
```

Three equations are tested
$$PU = \beta_{0} + \beta_{1}.PEOU + \epsilon$$

$$IU = \beta_{0} + \beta_{2}.PU + \beta_{3}.PEOU + \epsilon$$

$$AU = \beta_{0} + \beta_{4}.IU + \epsilon$$

---
class: title-slide, middle

## Exercise

In the research paper you have selected, write the equation corresponding to the model(s) (10min)

---
class: inverse, mline, left, middle

<img class="circle" src="https://github.com/damien-dupre.png" width="250px"/>

# Thanks for your attention and don't hesitate if you have any question!

[`r fa(name = "twitter")` @damien_dupre](http://twitter.com/damien_dupre)  
[`r fa(name = "github")` @damien-dupre](http://github.com/damien-dupre)  
[`r fa(name = "link")` damien-datasci-blog.netlify.app](https://damien-datasci-blog.netlify.app)  
[`r fa(name = "paper-plane")` damien.dupre@dcu.ie](mailto:damien.dupre@dcu.ie)
