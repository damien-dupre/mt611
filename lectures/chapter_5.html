<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>MT611 - Quantitative Research Methods</title>
    <meta charset="utf-8" />
    <meta name="author" content="Damien Dupr√©" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-extra-styles-0.2.6/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link href="libs/countdown-0.3.5/countdown.css" rel="stylesheet" />
    <script src="libs/countdown-0.3.5/countdown.js"></script>
    <link href="libs/font-awesome-animation-1.0/font-awesome-animation-emi.css" rel="stylesheet" />
    <script src="libs/fontawesome-5.0.13/js/fontawesome-all.min.js"></script>
    <link rel="stylesheet" href="css/custom_design.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# MT611 - Quantitative Research Methods
## Chapter 5: Introduction to R and Rmarkdown
### Damien Dupr√©
### Dublin City University

---






# Brief Introduction

Modern data science uses free and open-source computer languages:

* Proprietary languages (e.g., Matlab) and software (e.g., SPSS, Stata, SAS) are outdated
* Main open-source computer languages for data science are Python and R

While Python is the most used language by computer engineers for web and app development, R has some advantages:

.pull-left[
1. **Easy to write**, to read and to use
2. Focused on **reports and journal papers** with reproducibility
3. Advanced **statistical packages**
4. **Friendly and open** community

### So let's useR!
]

.pull-right[
&lt;img src="chapter_5_files/figure-html/unnamed-chunk-1-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

class: inverse, mline, center, middle

# 1. R and RStudio

---

# What are R and RStudio?

There are some key concepts you need to understand and to remember:

* R is the name of the language
* RStudio is the name of the upgraded interface to write R code

R is usually used via RStudio and First time users often confuse the two. At its simplest, **R is like a car‚Äôs engine** while **RStudio is like a car‚Äôs dashboard**.

.pull-left[
.center[R: The engine]
&lt;img src="img/car_motor.jpeg" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
.center[RStudio: The dashboard]
&lt;img src="img/car_dashboard.jpeg" width="100%" style="display: block; margin: auto;" /&gt;
]

---
class: clear

## .center[**Time to enter ...**]

--

&lt;img src="img/the_matrix.gif" width="150%" style="display: block; margin: auto;" /&gt;

---

# Rstudio Cloud

In your webrowser (Chrome, Firefox, ...), go to: https://rstudio.cloud/
  - Sign up
  - In your workspace, Click "new project"

&lt;img src="https://miro.medium.com/max/1400/1*JBHNRwGr3ZiyBzYWpvH6zg.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Code in Rstudio

Most of the R code displayed in this lecture is included in these slides. Rather than typing it manually, open these slides in another tab to copy-paste the code

Two ways to access these slides:

  - From Loop: Lectures Slides &gt; Chapter 5
  - Or from the URL: https://damien-dupre.github.io/mt611/lectures/chapter_5
  
&lt;img src="https://c.tenor.com/0heitU7-tg4AAAAC/copy-paste-paste.gif" width="50%" style="display: block; margin: auto;" /&gt;

---
class: inverse, mline, center, middle

# 2. Coding in RStudio

---

# RStudio IDE

When you open RStudio, you‚Äôll see the following 3 windows (also called panes):

* **Console**: where the results are printed
* **Workspace**: where the objects are stored
* **Files, Plots, Package, Help and Viewer**: where data science materials are

&lt;img src="img/rstudio_panes.png" width="70%" style="display: block; margin: auto;" /&gt;

The last window **Code Editor** opens when creating a new R Script or R Markdown file

---

# Console: R‚Äôs Heart

The console displays 1. What has been ran, 2. The results (or some parts) of has been ran, and 3. The status of the R process.

.pull-left[
The Status of R is indicated by the symbol in the console prompt:

* `&gt;` means ready to process code 
* `+` means incomplete command (escape with `ESC`)
* &amp;#128721; at the top right corner means the console is busy processing your code
]

.pull-right[
&lt;img src="img/r_console.png" width="100%" style="display: block; margin: auto;" /&gt;
]

You can execute code by typing it directly into the Console. __However, it will not be saved__. And if you make a mistake you will have to re-type everything all over again. 

Instead, it is better to write all your code in a document (R script or R Markdown) in the **Code Editor**.

---

# Environment: R‚Äôs Brain

The Environment tab of this pane shows you the names of all the data objects (like vectors, matrices, and data frames) that you have defined in your current R session. 

You can also see information like the number of observations and rows in data objects. 

&lt;img src="https://www.statology.org/wp-content/uploads/2021/10/envir1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Files / Plots / Packages / Help

* The **Files** panel gives you access to the file directory on your hard drive.

* The **Plots** panel shows all your plots. There are buttons for opening the plot in a separate window and exporting the plot as a pdf or jpeg.

* The **Packages** shows a list of all the R packages installed on the local or remote machine and indicates whether or not they are currently loaded.

* With the **Help** menu for R functions you can access to essential information to use them. Just have a look at some of them by typling `F1` with the cursor on the function or by typing `?` followed by the function name such as:


```r
?seq
?lm
```

---

# Code Editor: R's Nervous System

- It makes the link between all the previous pane and allows to reproduce actions and behaviours.

- You can open as many R Script / R Markdown as you want.

- These documents are the only documents that have to be saved. No need to save you data, figures and calculations as you can reproduce them every time instantaneously with the code.

- Save your eyes and look like a nerd by changing the code's appearance

&lt;img src="https://miro.medium.com/max/1600/1*eLjON45R_kHIfg_IgL8FIg.jpeg" width="60%" style="display: block; margin: auto;" /&gt;
.center.tiny[Credit: towardsdatascience.com [üîó](https://towardsdatascience.com/customize-your-rstudio-theme-914cca8b04b1)]

---
class: inverse, mline, center, middle

# 3. The Basics of R Code

---

# What are .R and .Rmd files?

**.R** is the extension for a R script (document including only R code): 
- Click **File &gt; New File &gt; R Script** in RStudio
- Includes only code which can be active or inactive (line starts with `#`)
- Used for code testing

Example of non-active code


```r
# non active code
```

Example of active code


```r
paste("active", "code")
```

```
## [1] "active code"
```

```r
1 + 1 # everything after `#` is non active and is used for comments
```

```
## [1] 2
```

---

# What are .R and .Rmd files?

**.Rmd** is the extension for a R Markdown file: 
- Click **File &gt; New File &gt; R Markdown...** in RStudio
- Refers to a document that includes code and text
- Generates a specific type of output
  - .html (web page, slides, books, and dashboards)
  - .pdf (Academic LaTex papers and reports)
  - .doc (MS Word documents)
  
&lt;img src="https://d33wubrfki0l68.cloudfront.net/59f29676ef5e4d74685e14f801bbc10c2dbd3cef/c0688/lesson-images/markdown-1-markup.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# How to Run R Code?

In a R Script, place your cursor anywhere on the line you want to run and either:

.pull-left[
- Press `Ctrl` &amp; `Enter` (Win)
- Press `Command` &amp; `Enter` (Mac)
- Click the `Run` button on RStudio's interface
]

.pull-right[
&lt;img src="https://appsilon.com/wp-content/uploads/2020/05/4_blog_code_execution_optimized.gif" width="100%" style="display: block; margin: auto;" /&gt;
]

In a R Markdown:
- Use the **green** arrow to run the current chunk of code
- Use the `Knit` button on RStudio's interface to create the output file

---

# What are R packages?

R packages extend the functionality of R. They are written by a worldwide community of R users and can be downloaded for free from the internet.

A good analogy for **R packages are like apps you can download onto a mobile phone**.

.pull-left[
.center[R: A new phone]
&lt;img src="img/phone_design.jpeg" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
.center[R Packages: Apps you can download]
&lt;img src="img/phone_apps.jpeg" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# What are R packages?

Say you have purchased a new phone, to use Instagram you need to **install the app once** and to **open the app** every time you want to use it.

The process is very similar for using an R package. You need to:

* **Install the package** with the function `install.packages()`.


```r
install.packages("praise")
```

* **‚ÄúLoad‚Äù the package** with the function `library()`. 


```r
library(praise)
```

Once the package is loaded you can use all the functions from this package such as:


```r
praise()
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

Open a R Script in RStudio. In this document:
- Use line 1 to **install the package "praise"**
- Use line 2 to **load the library praise**
- Use line 3 to **run the function `praise()`** as it is, without arguments

<div class="countdown" id="timer_624da3bf" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Calling Functions

Functions are algorithms (or lines of code) which transform data to something else. For example, the function `lm()`, uses data to compute the result of a linear regression model.
 
Functions are called by their name and have several arguments that require some information.


```r
function_name(argument_1 = value_1, argument_2 = value_2, ...)
```

For example, the function `seq()` makes a sequences of numbers:
* The first argument `from` is the number starting the sequence
* The second argument `to` is last number of the sequence


```r
seq(from = 1, to = 10)
```

```
##  [1]  1  2  3  4  5  6  7  8  9 10
```

---

# Assign Values to Objects in R

Usually the arguments of functions expects an Object name to access the data.

An object is a box that **can include anything** (e.g., values, dataframes, figures, models, functions, ...) and **has a name** that you have to choose. 

--

To create an object, you need to **assign something** to a name using the `&lt;-` operator. If you type the name of the object, R will print out its content.


```r
x &lt;- 4
x
```

--

It is very important to distinguish values and objects in R:

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Type &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Class &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Example &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Number &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numeric Value &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1, 2, ... &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Word with quotes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Character Value &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &amp;quot;one&amp;quot;, &amp;quot;two&amp;quot;, ... &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Word without quotes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Object Name &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; function name, data name, ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Different R Objects

All object assignments have the same form:


```r
object_name &lt;- object_content
```

You want your object names to be descriptive, so you will need a convention for multiple words. I recommend **snake_case** where you separate lower-case words with `_`.


```r
numeric_value &lt;- 1

character_value &lt;- "one"

vectors_with_numeric_values &lt;- c(1, 2)

vectors_with_character_values &lt;- c("one", "two")

dataframe_example &lt;- data.frame(col1 = c("one", "two"), col2 = c(1, 2))

dataframe_example &lt;- data.frame(
  col1 = vectors_with_character_values, 
  col2 = vectors_with_numeric_values
  )
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

In the same R Script in RStudio, **Copy and Paste and Run** the following code:

```
my_power &lt;- c(0.5, 99.5)

my_knowledge &lt;- c("without R", "with R")

barplot(height = my_power, names.arg = my_knowledge)
```

<div class="countdown" id="timer_624da386" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, mline, center, middle

# 4. Access Data in RStudio Cloud

---

# Open your Data as R Object (1)

RStudio Cloud is a free remote computer, the computing is not run on your computer.

To open Data on RStudio cloud, you first need to `Upload` your file on this computer and to `Import` the data in R.

.pull-left[
.center[Step 1: Upload your File]
&lt;img src="https://community-cdn.rstudio.com/uploads/default/original/2X/9/91a128299a9d910f84279be9ecd89b60aa15f20b.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
.center[Step 2: Import your Data]
&lt;img src="img/rstudio_import.png" width="100%" style="display: block; margin: auto;" /&gt;
]

Remember that **.csv files are basically text files**

---

# Open your Data as R Object (2)

For early beginners on the Desktop version, directly open data with RStudio 's `Import Dataset` button.

&lt;img src="https://support.rstudio.com/hc/article_attachments/360017333414/data-import-rstudio-overview.gif" width="70%" style="display: block; margin: auto;" /&gt;

If you see your data in the preview, you can click `Import` to create an object containing your data. A code will be executed on the console, **Copy and Paste the first line of this code in your R script**. You will not have to do it manually once the code is in your script.

---

# Open your Data as R Object (3)

To ensure code reproducibility, open data with the appropriate function (e.g., `read.csv()` for csv files).

The main argument of these functions is `file` which corresponds to the path to a file, followed by the name of the file and it extension:


```r
my_file_object &lt;- read.csv("C:/path/to/my/file.csv") # Windows
my_file_object &lt;- read.csv("/Users/path/to/my/file.csv") # Macos
```

The following codes will generate an error:


```r
# Incomplete path
my_file_object &lt;- read.csv("/path/to/my/file.csv")
# Missing file extension
my_file_object &lt;- read.csv("C:/path/to/my/file")
# Use of backward slash
my_file_object &lt;- read.csv("C:\path\to\my\file.csv")
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1. Click on `Upload` to upload your exercise data "{firstname}_data.csv" on your RStudio Cloud

2. Click on `Import` to import these data in R

<div class="countdown" id="timer_624da47d" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, mline, center, middle

# 5. Save Your Data

---

# Save Your Data

Usually, only R Script file (.R) or R Markdown file (.Rmd) have to be saved as they allow the full replicability of transformations and result.

However if you want to use the data that have been transformed, joined or pivoted, a function has to be used according the type of export.

The simplest export is a .csv file with the function `write.csv()`. It as two main arguments:
- `x` which is the name of the object to save
- `file` which is the name of the output file

Note: don't forget the file extension in the argument `file`

Example:


```r
# Saved in the current directory
write.csv(my_file_object, "my_file_name.csv")

# Saved in the directory you prefer
write.csv(my_file_object, "C:/path/to/my/my_file_name.csv") # Windows
write.csv(my_file_object, "/Users/path/to/my/my_file_name.csv") # Macos
```

---
class: title-slide, middle

## Exercise

Save your "{firstname}_data.csv" file under a new name by using the R object name that you previously gave

<div class="countdown" id="timer_624da47a" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---

# Become Expert in R

Because R is free, plenty of free learning materials are available online:

* Video tutorials in Youtube, Tik Tok (@chelseaparlettpelleriti, @tommyteaches, ...)
  
* Interactive tutorials, see for example:
  - [RStudio Primers](https://rstudio.cloud/learn/primers)
  - [R-Bootcamp](https://r-bootcamp.netlify.com)
  - [Introduction to R](https://www.quantargo.com/courses/course-r-introduction)
  - [DCU R tutorials](https://dcu-r-tutorials.netlify.app)

* Book tutorials, see for example:
  - [R for Data Science](https://r4ds.had.co.nz/) by Wickham &amp; Grolemund (2017)
  - [A ModernDive into R and the tidyverse](https://moderndive.com/) by Ismay &amp; Kim (2019)
  - [Getting Used to R, RStudio, and R Markdown](https://rbasics.netlify.com/) by Kennedy (2019)
  - [Introduction to Open Data Science](https://ohi-science.org/data-science-training/) by the Ocean Health Index Team (2019)
  
Note: All books are included in the [Big Book of R](https://www.bigbookofr.com/)

---

# How to solve your pRoblems

.pull-left[
### 1. Look at your error
  * If it's obvious, solve it by yourself
  * If it's not obvious, copy paste the error in google
  
### 2. Look at your object
  * `str(ObjectName)`

### 3. Look at the function
  * Documentation (`F1` or `?`)

### 4. Look at the web
  * Google "R how to ..."
  * Stack Overflow
]
.pull-right[
&lt;img src="https://pbs.twimg.com/media/DAsjfPjXkAIBoET?format=jpg&amp;name=medium" width="100%" style="display: block; margin: auto;" /&gt;
]

---
class: inverse, mline, center, middle

# 6. Transformations with {dplyr}

---

# Using {dplyr} in the {tidyverse}

The {tidyverse} package is primarily made up of a set of super useful R packages ({ggplot2}, {dplyr}, {purrr}, {tidyr}, {readr}, {tibble}).

It is also a new way of thinking about implementing ‚Äútidy‚Äù data analysis. 

If you combine tidy thinking with the {tidyverse} packages, you will inevitably become a master of tidy analysis. 

The tidyverse has a very detailed website for more information: https://www.tidyverse.org/.


```r
install.packages("tidyverse")
library(tidyverse)
```

---

# {dplyr}'s main functions

There are five **{dplyr}** functions that you will use to do the vast majority of data manipulations:

- `filter()`: Subset observations (pick observations by their values)

- `select()`: Subset variables (pick variables by their names)

- `mutate()`: Make new variables (create new variables with functions of existing variables)

- `summarise()`: Summarise data (collapse many values down to a single summary)

These can all be used in conjunction with `group_by()` which changes the scope of each function from operating on the entire dataset to operating on it group-by-group.

These five functions provide the verbs for a language of data manipulation.

---

# {dplyr}'s main functions

All verbs work similarly:

- &lt;span style='color: red;'&gt;The first argument is a dataframe object name&lt;/span&gt; 
- &lt;span style='color: green;'&gt;The subsequent arguments describe how the dataframe is transformed&lt;/span&gt; 
- &lt;span style='color: blue;'&gt;The result is a new dataframe&lt;/span&gt;

Here is a generic example:

.center[**&lt;span style='color: blue;'&gt;dataframe_transformed&lt;/span&gt; `&lt;-` function_name(&lt;span style='color: red;'&gt;dataframe_name&lt;/span&gt;, &lt;span style='color: green;'&gt;transformation&lt;/span&gt;)**
]

---

# The gapminder dataset

The dataset used today is stored in the {gapminder} package into an object called `gapminder`. 

Each row in this table corresponds to a country at a specific year. For each row, we have 6 columns:

- **country**: Name of country.
- **year**: Year of the observation (between 1952 and 2007).
- **pop**: Number of people living in the country.
- **continent**: Which of the five continents the country is part of. 
- **lifeExp**: Life expectancy in years.
- **gdpPercap**: Gross domestic product (in US dollars).

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1. Install the packages {tidyverse} and {gapminder} which contains the data gapminder
2. Load the package {gapminder} to access the data
3. Use the function `str()` on the gapminder data 

<div class="countdown" id="timer_624da3e3" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## The filter() function

---

# The filter() function

You will want to isolate bits of your data; maybe you want to only look at a single country or a few years. R calls this subsetting and `filter()` allows you to subset observations based on their values.

`filter()`'s transformation is a conditional statement, only observations TRUE to the condition are kept.

For example


```r
filter(gapminder, country == "Ireland")
```

Importantly, Column/Variable names are not between quotation marks in the Tidyverse whereas the value to filter is:

- A Column/Variable is an object containing multiple values inside the data frame object.
- The string "Ireland" does not exist in our environment and will not be saved. It is here just as a value, which explains the quotation marks.

---

# Comparisons

To use filtering effectively, you have to know how to select the observations that you want using the comparison operators. R provides the standard suite: `&gt;`, `&gt;=`, `&lt;`, `&lt;=`, `!=` (not equal), and `==` (exactly equal).

When you are starting out with R, the easiest mistake to make is to use `=` instead of `==` when testing for equality. When this happens you will get an informative error:


```r
filter(gapminder, country = "Ireland")
```

```
## Error in `check_filter()`:
## ! Problem with `filter()` input `..1`.
## x Input `..1` is named.
## ‚Ñπ This usually means that you've used `=` instead of `==`.
## ‚Ñπ Did you mean `country == "Ireland"`?
```

---

# Multiple filters

Whereas the `filter()` can include as many conditions as possible, it is also possible to store the result of the `filter()` function in a new object and then to apply a new filter on this new object.


```r
gapminder_ireland &lt;- filter(gapminder, country == "Ireland")

gapminder_ireland_2007 &lt;- filter(gapminder_ireland, year == 2007)
```

A choice is offered to you, you can either overwrite the original object by using the same object name or to use a different object name.

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1. Be sure that the packages {tidyverse} and {gapminder} are loaded
2. Create a new object that only contains `gapminder` data for France
3. Create a new object using the previous object that only contains data for France in 1982

<div class="countdown" id="timer_624da275" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## The select() function

---

# The select() function

It is not uncommon to get datasets with hundreds or even thousands of variables. In this case, the first challenge is often narrowing in on the variables you are actually interested in. 

`select()` allows you to rapidly zoom in on a useful subset using operations based on the names of the variables. 

Again the first argument is the name of the data frame object to process and the following arguments are the name of the columns to keep.


```r
select(gapminder, country, year, pop)
```

---

# Keep and remove variables

The `select()` function can not only be used to keep specific variables but it can also be used to remove them from the data frame object. 

To do so, just add the `-` sign in front of the variable name to be removed. For example:


```r
gapminder_keep &lt;- select(gapminder, country, year, pop)

gapminder_remove &lt;- select(gapminder, -continent, -lifeExp, -gdpPercap)
```

<span>&lt;i class="fas  fa-arrow-circle-right faa-horizontal animated faa-slow " style=" color:blue;"&gt;&lt;/i&gt;</span> In the previous example the objects `gapminder_keep` and `gapminder_remove` should have the same number of variable and therefore be equal.

---

# Select and rename variables

While you are keeping only specify variables with `select()`, these variables can also be renamed on the same time. 

The new name has to be first, followed by the `=` sign, and the old name.

Example:


```r
select(gapminder, country, population = pop, measure_year = year)
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1/ From the data frame object `gapminder`, select the columns `lifeExp` and `gdpPercap` and rename them as life_expectancy and gdp_per_capita:


```r
select(_ _ _, _ _ _ = _ _ _, _ _ _ = _ _ _)
```

2/ From the data frame object `gapminder`, remove the columns `pop` and `year` and assign the result in a new object. The display the value of this object:


```r
new_data &lt;- select(_ _ _, -_ _ _, -_ _ _)

new_data
```

<div class="countdown" id="timer_624da2ec" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## The mutate() function

---

# The mutate() function

Besides selecting sets of existing columns, it is often useful to add new columns that are functions of existing columns. That is the job of `mutate()`. 

Once again the first argument is the name of the data frame object to modify, then the second argument is the name of the column to create followed by the `=` sign and the condition creating the new values.

For example we can create a new column called `gdp_total` which contains the values resulting from the multiplication between `pop` and `gdpPercap`:


```r
mutate(gapminder, gdp_total = pop * gdpPercap)
```

`mutate()` can also create multiple columns in the same statement, they just have to be separated by a comma `,`.

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1/ From the data frame object `gapminder`, create a new column called `country_upper` with the function `toupper()` using the column `country`:


```r
mutate(_ _ _, _ _ _ = _ _ _(_ _ _))
```

2/ From the data frame object `gapminder`, filter the countries in Europe and their values for 2007. Assign the result to an new object called `europe_2007`. 
Then create a new column called `europe_prop` corresponding to the value of the column `pop` divided by the total population in Europe in 2007.


```r
europe_2007 &lt;- filter(_ _ _, _ _ _ == _ _ _ &amp; _ _ _ == _ _ _)

mutate(_ _ _, _ _ _ = _ _ _/_ _ _(_ _ _))
```

<div class="countdown" id="timer_624da221" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## The summarise() function

---

# The summarise() function

The last key verb is `summarise()`. It collapses a data frame to a single row:


```r
summarise(gapminder, mean(pop))
summarise(gapminder, sd(pop))
```

The result of `summarise()` is a dataframe, the default header of the summary is the calculation but a new header can be defined by using the `=` sign when summarising the data:


```r
summarise(gapminder, m_pop = mean(pop))
summarise(gapminder, sd_pop = sd(pop))
```

Finally, more than one summary can be done inside a `summarise()`:


```r
summarise(gapminder, m_pop = mean(pop), sd_pop = sd(pop))
```

---

# The summarise() function

`summarise()` is not terribly useful unless we pair it with `group_by()`. This changes the unit of analysis from the complete dataset to individual groups. Then, when you use the dplyr verbs on a grouped data frame they‚Äôll be automatically applied ‚Äúby group‚Äù. 

For example, if we applied exactly the same code to a data frame grouped by year, we get the average world population per year:


```r
gapminder_by_year &lt;- group_by(gapminder, year)

summarise(gapminder_by_year, mean_pop = mean(pop))
```

```
## # A tibble: 12 √ó 2
##     year  mean_pop
##    &lt;int&gt;     &lt;dbl&gt;
##  1  1952 16950402.
##  2  1957 18763413.
##  3  1962 20421007.
##  4  1967 22658298.
##  5  1972 25189980.
##  6  1977 27676379.
##  7  1982 30207302.
##  8  1987 33038573.
##  9  1992 35990917.
## 10  1997 38839468.
## 11  2002 41457589.
## 12  2007 44021220.
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1/ From the data frame object `gapminder`, summarise the population average with the `mean()` function by `year` and by `continent` by adding the second grouping variable after the first one (use a coma to separate them):


```r
gapminder_group &lt;- group_by(_ _ _, _ _ _, _ _ _)

summarise(_ _ _, _ _ _ = _ _ _(_ _ _))
```

2/ From the data frame object `gapminder`, summarise the population standard deviation with the `sd()` function by `year` and by `continent` by adding the second grouping variable after the first one (use a coma to separate them):


```r
gapminder_group &lt;- group_by(_ _ _, _ _ _, _ _ _)

summarise(_ _ _, _ _ _ = _ _ _(_ _ _))
```

<div class="countdown" id="timer_624da0f2" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## The pipe operator %&gt;%

---

# The Pipe Operator %&gt;% (1)

We have seen how to create a sequence of numbers from 1 to 10 using the function `seq()`:


```r
seq(1, 10)
#  [1]  1  2  3  4  5  6  7  8  9 10
```

If you want to know the sum of the numbers from 1 to 10, you might write some code like:


```r
sum(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10))
```

To make the code shorter you could do instead:


```r
sum(seq(1, 10))
```

The **tidyverse** makes heavy use of the pipe operator (`%&gt;%`), which __takes whatever is on the left-hand-side of the pipe and makes it the first argument of whatever function is on the right-hand-side of the pipe__. 

Therefore `seq(1, 10) %&gt;% sum()` is equivalent to `sum(seq(1, 10))`.


```r
seq(1, 10) %&gt;% sum()
```

---

# The Pipe Operator %&gt;% (2)

Imagine you have a dataset made of 2 columns and you want to create a 3rd column which is the result of the addition of column 1 and column 2. Then you want to keep only the observations lower than 10, you might write code like this:


```r
data_with_third_column &lt;- mutate(data, column_3 = column_1 + column_2)

data_filter_third_column &lt;- filter(data_with_third_column, column_3 &lt; 10)
```

--

There‚Äôs another way to tackle the same problem with the pipe, `%&gt;%`:


```r
data_filter_third_column &lt;- data %&gt;% 
  mutate(column_3 = column_1 + column_2) %&gt;% 
  filter(column_3 &lt; 10)
```

--

You can read it as a series of imperative statements: 

&gt; Create a new object call `data_filter_third_column` which takes the object `data`, **then** create a new column called `column_3`, **then** filter this column by keeping only the values lower than 10.

A good way to pronounce the pipe `%&gt;%` when reading code is **‚Äúthen‚Äù**.

---

# The pipe operator %&gt;%

Imagine that we want to summarise the population average and standard deviation only of Europe. Using what you know about {dplyr}, you might write code like this:


```r
gapminder_europe &lt;- filter(gapminder, continent == "Europe")

gapminder_summary_europe &lt;- summarise(gapminder_europe, 
    m_pop = mean(pop),
    sd_pop = sd(pop)
  )
```

This code is a little frustrating to write because we have to give each intermediate data frame a name, even though we don‚Äôt care about it. Naming things is hard, so this slows down our analysis.

--

There is another way to tackle the same problem with the pipe, `%&gt;%`:


```r
gapminder_summary_europe &lt;- gapminder %&gt;% 
  filter(continent == "Europe") %&gt;% 
  summarise(m_pop = mean(pop), sd_pop = sd(pop))
```

---

# The pipe operator %&gt;%


```r
gapminder_summary_europe &lt;- gapminder %&gt;% 
  filter(continent == "Europe") %&gt;% 
  summarise(m_pop = mean(pop), sd_pop = sd(pop))
```

Becomes

&gt; Create the object "gapminder_summary_europe" from the object "gapminder", then

&gt; Filter all the values exactly equals to "Europe" in the continent variable, then

&gt; Summarise the average population as "m_pop" and the standard deviation as "sd_pop".

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

1. If it hasn't been done already, load the tidyverse package

2. Execute the following code:



<div class="countdown" id="timer_624da180" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## Exercise

1/ From the data frame object `gapminder`, summarise the population average with the `mean()` function by `year` and by `continent` by adding the second grouping variable after the first one (use a coma to separate them) and by using the pipe operator:


```r
_ _ _ %&gt;% 
  group_by(_ _ _, _ _ _) %&gt;% 
  summarise(_ _ _ = _ _ _(_ _ _))
```

2/ From the data frame object `gapminder`, summarise the population standard deviation with the `sd()` function by `year` and by `continent` by adding the second grouping variable after the first one (use a coma to separate them) and by using the pipe operator:


```r
_ _ _ %&gt;% 
  group_by(_ _ _, _ _ _) %&gt;% 
  summarise(_ _ _ = _ _ _(_ _ _))
```

<div class="countdown" id="timer_624da34d" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, mline, center, middle

# 7. Visualistions with {ggplot2}

---

# Disable Scientific Number Format

By __default R uses scientific number format__ to display values when they are too long, which usually append in visualisations.

For example `1000000` is printed as:


```
## [1] "1e+06"
```

To disable this scientific number format, include and __run the following code__ at the beginning of every script (ideally after loading the libraries) every time you restart R:


```r
options(scipen = 999)
```

Now, `1000000` is printed as:


```
## [1] 1000000
```

And your visualisations will not use the scientific number format anymore

---

# Using {ggplot2} in the {tidyverse}

The {ggplot2} package, as it provides an **easy way to create and to customise your plots**.

As a part of the {tidyverse} package, {ggplot2} is loaded when {tidyverse} is loaded as well:


```r
# install.packages("tidyverse") if not done already (check list of packages)
library(tidyverse)
```

--

**‚Äúthe grammar of graphics‚Äù** (the ‚Äúgg‚Äù in ggplot) defines a set of rules for constructing statistical graphics by combining different types of layers. 

From the first (bottom) to the last (top), the mandatory layers are :

&lt;img src="https://englelab.gatech.edu/useRguide/images/dataviz/ge_geom.png" width="50%" style="display: block; margin: auto;" /&gt;

---

# Data

In {ggplot2}, the **data** layer is the name of the object that contains the variables to plot.

The visualisation is initiated with the function `ggplot()`


```r
ggplot(data = my_dataframe) # the argument name can be omitted too
```

--

Let's try to use the gapminder data:


```r
ggplot(data = gapminder) # or ggplot(gapminder)
```

&lt;img src="chapter_5_files/figure-html/unnamed-chunk-81-1.png" width="504" style="display: block; margin: auto;" /&gt;

Only a grey frame is displayed: we need to define the axes (aesthetic mapping) and their corresponding layers.

**Then additional, layers are added with the symbol `+`.**

---

# Aesthetic Mapping

The **aesthetic mapping** refers to the frame of the plot, `x` for the variable in the x-axis and `y` for the variable in the y-axis. There are many more aesthetics such as `color`, `fill` and `group` but let's focus on the x and y axes for the moment. The mapping is performed by a function in {ggplot2} called `aes()` for aesthetics. 

This is an essential concept to remember, the mapping of a plot (frame axes) is built from aesthetics.


```r
ggplot(data = my_dataframe) +
  aes(x = my_xaxis_variable, y = my_yaxis_variable)
```

--

Again, the arguments names of the `ggplot()` function and layers can be omitted if filled in the right order:


```r
ggplot(my_dataframe) +
  aes(my_xaxis_variable, my_yaxis_variable)
```

Obviously, some type of layers are not suitable for all aesthetics, it depends on how many variables are included and their type (categorical or continuous). 

---

# Aesthetic Mapping

.pull-left[
**Aesthetic mapping represents** not only the variables defined as **x-axis** and **y-axis** but also, **colours** of borders (colors), colours of shapes (fill), **shapes**, **size**, ...
]

.pull-right[

```r
ggplot(data = my_dataframe) +
 aes(
   x = my_xaxis_variable, 
   y = my_yaxis_variable,
   color = my_color_variable,
   fill = my_fill_variable,
   shape = my_shape_variable,
   size = my_size_variable
  )
```
]

--

For example, the following code is adding not only a x- and y-axis to a scatter plot, but also colours to the points:

.pull-left[

```r
ggplot(data = gapminder) +
  aes(
    x = gdpPercap, 
    y = lifeExp, 
    color = continent
  )
```
]

.pull-right[
&lt;img src="chapter_5_files/figure-html/aesthetic-1.png" width="672" style="display: block; margin: auto;" /&gt;
]

---

# Geometries

**Geometries**, which are shapes we use to represent our data. There is a dedicated function for every type of shape to plot but all start with `geom_`

|function          |shape    |
|------------------|---------|
|`geom_point()`    |point    |
|`geom_line()`     |line     |
|`geom_bar()`      |bar      |
|`geom_histogram()`|histogram|
|`geom_boxplot()`  |boxplot  |
|...               |...      |

The list is very long but here are the main ones. Multiple **geometries** can be added as layers by using the same `+` symbol. 

---

# Geometries

Example for scatter plots:


```r
ggplot(data = my_dataframe) +
  aes(x = my_xaxis_variable, y = my_yaxis_variable) +
  geom_point() 
```

Example for line graph:


```r
ggplot(data = my_dataframe) +
  aes(x = my_xaxis_variable, y = my_yaxis_variable) +
  geom_line() 
```

Example for bar graph:


```r
ggplot(data = my_dataframe) +
  aes(x = my_xaxis_variable, y = my_yaxis_variable) +
  geom_col() 
```

<span>&lt;i class="fas  fa-arrow-circle-right faa-horizontal animated faa-slow " style=" color:blue;"&gt;&lt;/i&gt;</span> Note: Not all data is suitable for all types of geometries. You have to find the geometry that corresponds to your data.

---

# Geometries Applied to gapminder

Example for scatter plots:


```r
ggplot(data = gapminder) +
  aes(x = gdpPercap, y = lifeExp, color = continent) +
  geom_point() 
```

&lt;img src="chapter_5_files/figure-html/unnamed-chunk-89-1.png" width="720" style="display: block; margin: auto;" /&gt;

---

# Geometries Applied to gapminder

Example for line graph:


```r
ggplot(data = gapminder) +
  aes(x = year, y = lifeExp, color = country) +
  geom_line() +
  guides(color ="none") # removes legend because too many countries
```

&lt;img src="chapter_5_files/figure-html/unnamed-chunk-90-1.png" width="720" style="display: block; margin: auto;" /&gt;

---

# Geometries Applied to gapminder

Example for bar graph:


```r
gapminder_avg_continent_2007 &lt;- gapminder %&gt;% 
  filter(year == 2007) %&gt;% 
  group_by(continent) %&gt;% 
  summarise(m_lifeExp = mean(lifeExp))

ggplot(data = gapminder_avg_continent_2007) +
  aes(x = continent, y = m_lifeExp, fill = continent) +
  geom_col() 
```

&lt;img src="chapter_5_files/figure-html/unnamed-chunk-91-1.png" width="864" style="display: block; margin: auto;" /&gt;

---

# Geometries with Statistics

`geom_smooth()` has one important extra argument called `method`. If method has the value "lm", a linear regression will be shown. If method has the value "loess" or "gam", a non-linear regression will be shown.


```r
ggplot(gapminder) +
  aes(x = year, y = lifeExp, color = continent) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_classic()
```

```
## `geom_smooth()` using formula 'y ~ x'
```

&lt;img src="chapter_5_files/figure-html/unnamed-chunk-92-1.png" width="864" style="display: block; margin: auto;" /&gt;

---

# Inherited Propriety of Geometries

You can add as many geometry layers as you want, however repeating the mapping for each geometry layer is very redundant. 

Thankfully, if all your geometry layers are using the same aesthetics mapping, __it is possible to include this mapping inside the `ggplot()`__, then all the geometry layers will have the same mapping:


```r
ggplot(gapminder, aes(x = year, y = lifeExp, color = country)) +
  geom_point() +
  geom_line()
```

--

If aesthetics are different for several geometry layers, it is also __possible to declare the aesthetics in the geometry__:


```r
ggplot(gapminder) +
  geom_point(aes(x = year, y = lifeExp, shape = continent)) +
  geom_line(aes(x = year, y = lifeExp, color = country))
```

---

# Themes

Now, to make the plot more professional, let's remove that standard grey background using a different theme. 

Many themes come built into the {ggplot2} package. My preference is `theme_bw()` but once you start typing `theme_` a list of options will pop up.


```r
ggplot(gapminder) +
  aes(x = gdpPercap, y = lifeExp, color = continent) +
  geom_point() +
  theme_bw()
```

&lt;img src="chapter_5_files/figure-html/unnamed-chunk-95-1.png" width="864" style="display: block; margin: auto;" /&gt;

---

# Themes

Built-in ggplot2 themes includes:

- `theme_bw()`
- `theme_classic()`
- `theme_minimal()`
- `theme_dark()`
- `theme_light()`
- ... 

&lt;img src="https://thinkr.fr/wp-content/uploads/2019/07/ggplot-meme.jpg" width="80%" style="display: block; margin: auto;" /&gt;

---

# Customising Plots

Take a look at the ggplot2 [cheat sheet](https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf), and think of ways you could improve the plot.

&lt;img src="https://d33wubrfki0l68.cloudfront.net/21d683072b0c21cbd9b41fc0e37a587ad26b9525/cbf41/wp-content/uploads/2018/08/data-visualization-2.1.png" width="75%"&gt;

---

# Include ggplot in pipes

A very powerful way to create figures in R is to use a __ggplot at the end of a data transformation pipe__.

Indeed, having a data frame object as first argument of the `ggplot()` function is similar to using a pipe operator and chaining it to the `ggplot()` function:


```r
# this classic representation:
ggplot(data = gapminder) +
  aes(x = gdpPercap, y = lifeExp, color = continent)
  geom_point()

# is the same as:
gapminder %&gt;% 
  ggplot() +
  aes(x = gdpPercap, y = lifeExp, color = continent) +
  geom_point()

# is the same as:
gapminder %&gt;% 
  ggplot(aes(x = gdpPercap, y = lifeExp, color = continent)) +
  geom_point()
```

The layers are still added with the `+` symbol.

---

# Include ggplot in pipes

By using the pipe with the data argument of `ggplot()`, it is also possible to modify the data frame using `filter()`, `select()`, `mutate()`, and `summarise()`.

Examples:

- `mutate()` and `filter()` to `ggplot()`:


```r
gapminder %&gt;% 
  mutate(gdpPercountry = gdpPercap*pop) %&gt;% 
  filter(country == "Ireland") %&gt;% 
  ggplot(aes(gdpPercountry, lifeExp, color = country)) +
  geom_line()
```

- `filter()` and `summarise()` to `ggplot()`:


```r
gapminder %&gt;% 
  filter(year == 2007) %&gt;% 
  group_by(continent) %&gt;% 
  summarise(s_pop = sum(pop)) %&gt;% 
  ggplot(aes(continent, s_pop, fill = continent)) +
  geom_col()
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

Build a ggplot with the `gapminder` dataset and one `geom_boxplot()` layer
which contains the x as `continent`, y as `lifeExp` and color as `continent` 
in its `aes()`. Use a theme of your choice as well:


```r
_ _ _(_ _ _) +
  aes(x = _ _ _, y = _ _ _, color = _ _ _) +
  _ _ _() +
  _ _ _()
```

Build a ggplot with the `gapminder` dataset and one `geom_col()` layer which contains the x as `year`, y as `pop` and fill as `continent` in its `aes()`. Use a theme of your choice as well:


```r
_ _ _(_ _ _) +
  aes(x = _ _ _, y = _ _ _, fill = _ _ _)
  _ _ _() +
  _ _ _()
```

<div class="countdown" id="timer_624da3bb" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, mline, center, middle

# 8. Linear Regression Models in R

---

# Model and Equations

A model contains:

- Only one Outcome/Dependent Variable
- One or more Predictor/Independent Variables of any type (categorical or continuous)
- Main and/or Interaction Effects

To evaluate their relationship with the outcome, each effect hypothesis is related with a coefficient called **Estimate** and represented with `\(b\)` as follow:

`$$Outcome = b_0 + b_1 Pred1 + b_2 Pred2 + b_3 Pred1 * Pred2 + e$$`

Testing for the significance of the effect means evaluating if this estimate `\(b\)` value is significantly **different, higher or lower than 0** as hypothesised in `\(H_a\)` by the scientist.

---

# Estimates and Linear Regression in R

The `lm()` function calculate each estimate and test them against 0 for you.

`lm()` has only two arguments that you should care about: `formula` and `data`. 

- `formula` is the translation of the equation of the model

- `data` is the name of the data frame object containing the variables.

Here is a generic example:


```r
lm(formula = Outcome ~ Pred1 + Pred2, data = my_data_object)
```

Here is an example with {gapminder}:


```r
lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)
```

---

# Mastering the Formula

`lm()` has only one difficulty, the `formula`. The `formula` is the direct translation of the equation tested but with its own representation:

1. The = sign is replaced by `~` (read "according to" or "by")
2. Each predictor is added with the `+` sign
3. An interaction effect uses the symbol `:` instead of *

--

Here are some generic equations and their conversion in `formula`:

`$$Outcome = b_0 + b_1 Pred1 + b_2 Pred2 + e$$`


```r
lm(formula = Outcome ~ Pred1 + Pred2, data = my_data_object)
```

`$$Outcome = b_0 + b_1 Pred1 + b_2 Pred2 + b_3 Pred3 + e$$`


```r
lm(formula = Outcome ~ Pred1 + Pred2 + Pred3, data = my_data_object)
```

`$$Outcome = b_0 + b_1 Pred1 + b_2 Pred2 + b_3 Pred1*Pred2 + e$$`


```r
lm(formula = Outcome ~ Pred1 + Pred2 + Pred1 : Pred2, data = my_data_object)
```

---

# Mastering the Formula

Here are some equations from the gapminder dataset and their conversion in `formula`:

--

`$$lifeExp = b_0 + b_1 gdpPercap + b_2 year + e$$`


```r
lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)
```

--

`$$lifeExp = b_0 + b_1 gdpPercap + b_2 year + b_3 gdpPercap * year + e$$`


```r
lm(formula = lifeExp ~ gdpPercap + year + gdpPercap : year , data = gapminder)
```

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

Test the following models in RStudio Cloud:

`$$pop = b_0 + b_1 gdpPercap + b_2 lifeExp + e$$`

`$$pop = b_0 + b_1 gdpPercap + b_2 lifeExp + b_3 gdpPercap * lifeExp + e$$`

<div class="countdown" id="timer_624da1dc" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## Linear Regression Results

---

# Categorical Predictor

Exactly as in Jamovi, `lm()` by default investigates continuous predictors or categorical predictors having 2 categories:


```r
model_gapminder &lt;- lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)
```

However, to test the hypothesis of a categorical predictor having 3 or more categories, the ANOVA omnibus test is required.

It can be obtained by using the `aov()` function with the lm model as input:


```r
model_gapminder &lt;- lm(formula = lifeExp ~ country + year, data = gapminder)

aov(model_gapminder)
```

To make the code shorter, it is possible to pipe this `aov()`


```r
model_gapminder &lt;- lm(formula = lifeExp ~ country + year, data = gapminder) %&gt;% aov()
```

---

# LM Summary

While the function `lm()` computes the model, the function `summary()` display the results


```r
model_gapminder &lt;- lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)

summary(model_gapminder)
```

```
## 
## Call:
## lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -67.262  -6.954   1.219   7.759  19.553 
## 
## Coefficients:
##                  Estimate    Std. Error t value
## (Intercept) -418.42425945   27.61713769  -15.15
## gdpPercap      0.00066973    0.00002447   27.37
## year           0.23898275    0.01397107   17.11
##                        Pr(&gt;|t|)    
## (Intercept) &lt;0.0000000000000002 ***
## gdpPercap   &lt;0.0000000000000002 ***
## year        &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 9.694 on 1701 degrees of freedom
## Multiple R-squared:  0.4375,	Adjusted R-squared:  0.4368 
## F-statistic: 661.4 on 2 and 1701 DF,  p-value: &lt; 0.00000000000000022
```

---

# LM Summary

The output of the `summary()` function is pretty dense, but let's analyse it line by line. 

The first line reminds us of what the actual regression model is:

```
Call:
lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)
```

The next part provides a quick summary of the residuals (i.e., the &amp;epsilon; values),

```
Residuals:
    Min      1Q  Median      3Q     Max 
-67.262  -6.954   1.219   7.759  19.553 
```

This can be convenient as a quick check that the model is okay. **Linear regression assumes that these residuals were normally distributed, with mean 0.** In particular it‚Äôs worth quickly checking to see if the median is close to zero, and to see if the first quartile is about the same size as the third quartile. If they look badly off, there‚Äôs a good chance that the assumptions of regression are violated. 

---

# LM Summary

The next part of the R output looks at the coefficients of the regression model:

```
Coefficients:
                 Estimate    Std. Error t value            Pr(&gt;|t|)    
(Intercept) -418.42425945   27.61713769  -15.15 &lt;0.0000000000000002 ***
gdpPercap      0.00066973    0.00002447   27.37 &lt;0.0000000000000002 ***
year           0.23898275    0.01397107   17.11 &lt;0.0000000000000002 ***
---
Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1
```

Each row in this table refers to one of the coefficient estimated in the regression model. 

The first row is the intercept term, and the later ones look at each of the predictors. The columns give you all of the relevant information:
- The first column is the actual estimate of b (e.g., -418.42425945 for the intercept, 0.00066973 for gdpPercap and 0.23898275 for year). 
- The second column is the standard error estimate (SE). 
- The third column gives you the t-statistic. 
- Finally, the fourth column gives you the actual p value for each of these tests. 

---

# LM Summary

The only thing that the previous table doesn‚Äôt list is the degrees of freedom used in the t-test, which is always N‚àíK‚àí1 and is listed immediately below, in this line:

```
Residual standard error: 9.694 on 1701 degrees of freedom
```

The value of df=1701 is equal to N‚àíK‚àí1, so that‚Äôs what we use for our t-tests. In the final part of the output we have the F-test and the R&lt;sup&gt;2&lt;/sup&gt; values which assess the performance of the model as a whole

```
Multiple R-squared:  0.4375,	Adjusted R-squared:  0.4368 
F-statistic: 661.4 on 2 and 1701 DF,  p-value: &lt; 0.00000000000000022
```

So in this case, the model did not perform significantly better than you‚Äôd expect by chance (F(2,1701) = 661.4, p &lt; 0.001), which isn‚Äôt all that surprising: the R&lt;sup&gt;2&lt;/sup&gt; = 0.4375 value indicate that the regression model accounts for 43.7% of the variability in the outcome measure. 

When we look back up at the t-tests for each of the individual coefficients, we have pretty strong evidence that gdpPercap and year have a significant effect. 

---

# Reporting Clean Results

To communicate about your statistical analyses in an academic report, the simplest method is to find the values in the `summary()` output and to copy-paste them in the text according to the format expected that we have seen in the previous lectures.

However, this task can be long, difficult and lead to human errors. Thankfully, R has additional packages that are providing alternative functions to read linear regression models and communicate results. Because there are too many packages, I will focus only on one additional packages: {report}.

&lt;img src="https://memegenerator.net/img/instances/73408711/whoa-i-know-linear-regression.jpg" style="display: block; margin: auto;" /&gt;

---

# Automatic Results with {report}

To install {report} use the usual `install.packages()` function:


```r
install.packages("report")
```

The package {report} will print a text containing all the statistics already in sentences ready to be interpreted (see https://easystats.github.io/report/).

To print the statistical analyses:

1. Load the package {report}
2. Create an object containing the output of the function `lm()`
3. Use this object as input of the function `report()` from the {report} package

**Note: If used in a RMarkdown document, the chunk containing `report()` has to include the chunk option `results='asis'`**

---

# Automatic Results with {report}


```r
library(report)

model_gapminder &lt;- lm(formula = lifeExp ~ gdpPercap + year, data = gapminder)

report(model_gapminder)
```

We fitted a linear model (estimated using OLS) to predict lifeExp with gdpPercap and year (formula: lifeExp ~ gdpPercap + year). The model explains a statistically significant and substantial proportion of variance (R2 = 0.44, F(2, 1701) = 661.44, p &lt; .001, adj. R2 = 0.44). The model's intercept, corresponding to gdpPercap = 0 and year = 0, is at -418.42 (95% CI [-472.59, -364.26], t(1701) = -15.15, p &lt; .001). Within this model:

  - The effect of gdpPercap is statistically significant and positive (beta = 6.70e-04, 95% CI [6.22e-04, 7.18e-04], t(1701) = 27.37, p &lt; .001; Std. beta = 0.51, 95% CI [0.47, 0.55])
  - The effect of year is statistically significant and positive (beta = 0.24, 95% CI [0.21, 0.27], t(1701) = 17.11, p &lt; .001; Std. beta = 0.32, 95% CI [0.28, 0.36])

Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.

---
class: title-slide, middle

## Live Demo

---
class: title-slide, middle

## Exercise

In RStudio Cloud, check the `report()` output from the `lm()` function testing the following models:

`$$pop = b_0 + b_1 gdpPercap + b_2 lifeExp + e$$`

`$$pop = b_0 + b_1 gdpPercap + b_2 lifeExp + b_3 gdpPercap * lifeExp + e$$`

<div class="countdown" id="timer_624da423" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, mline, center, middle

# 9. Academic Reports with Rmarkdown

---

# Objectives

In this lecture, with RStudio Cloud, we will see how to create **R Markdown** files (.Rmd) to embed text and code output and generate professional outputs.

--

#### What do I need to do before starting?

- Sign up for a free RStudio cloud account
- https://rstudio.cloud/

--

#### Where can I find more resources?

- More slides: 
  - [slides.djnavarro.net/starting-rmarkdown](https://slides.djnavarro.net/starting-rmarkdown)
  - [rmd4pharma.netlify.app/rmd-anatomy](https://rmd4pharma.netlify.app/static/slides/01-rmd-anatomy.html)
  - [rmd4pharma.netlify.app/graphics](https://rmd4pharma.netlify.app/static/slides/03-graphics.html)
- YouTube videos: [youtube.djnavarro.net/starting-rmarkdown](https://youtube.djnavarro.net/starting-rmarkdown)

---

# Two Sides of R Markdown Files

.pull-left[
### On the editor side...

- Write text in markdown
- Insert code using R
- Write "metadata" with YAML
]

.pull-right[
### On the output side...

- Output to HTML
- Output to PDF
- Output to Word
- Many other variations too
]

--

Try it by yourself:

1. Create a new R Markdown document: `File &gt; New File &gt; R Markdown`
2. A popup will appear, leave everything as default and click `Yes`
3. A new popup will appear, leave everything as default and click `OK`

--

## Let's dissect the document obtained!

---

# R Markdown Structure

R Markdown files have 3 different types of content:

#### 1. The YAML

Displayed between two series of `---` signs, it corresponds to the metadata shown in the header of the output file (e.g., title, author, date, ...) and the type of output (e.g., pdf, html, doc, ...)

#### 2. The Text

Written in Markdown style (i.e., text without formatting), it is used as core description in the output document

#### 3. The Code

Inserted in the R Markdown inside "chunks", the code is processed when creating the output and can display figures and tables

---

# The part inside --- is the "YAML"

&lt;img src="img/my_first_rmd_html_yaml.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# The text is Markdown 

&lt;img src="img/my_first_rmd_html_markdown.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# The part in grey is R code

&lt;img src="img/my_first_rmd_html_r.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# Create the Output File

.pull-left[
To generate the output file:

1. Go to `File &gt; Knit Document` (a `Knit` shortcut icon is also displayed in the menu bar)
2. Give a name to your document and click `OK`

&lt;img src="https://tech.me.holycross.edu/files/2016/12/knit.png" width="80%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="img/html_output.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

# R Markdown Editor vs Output

.pull-left[
&lt;img src="img/my_first_rmd_html.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="img/html_output.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
class: title-slide, middle

## The YAML

---

# Output HTML

### Simple

```
---
output: html_document
---
```

--

### Default

```
---
title: "My First R Markdown Document"
output: html_document
date: "99/99/9999"
---
```

--

### Elaborated

```
---
title: "My First R Markdown Document"
subtitle: "My Subtitle"
author: "Damien Dupre"
date: "99/99/9999"
output: html_document
---
```

---
class: title-slide, middle

## Markdown Style

---

# Emphasising text

--
.pull-left[
&lt;br&gt;&lt;br&gt;
### What you type...
&lt;br&gt;
```

this is *italics*

this is **bold**

this is ***bold italics***
```
]
--
.pull-right[
&lt;br&gt;&lt;br&gt;
### What you get...
&lt;br&gt;

this is *italics*

this is **bold**

this is ***bold italics***
]

---

# Creating lists

--
.pull-left[
&lt;br&gt;&lt;br&gt;
### What you type...
&lt;br&gt;
```
- unnumbered lists
- look like this

1. numbered lists
2. look like this
```
]
--
.pull-right[
&lt;br&gt;&lt;br&gt;
### What you get...
&lt;br&gt;

- unnumbered lists
- look like this

1. numbered lists
2. look like this
]

---

# Creating headings

--
.pull-left[
&lt;br&gt;&lt;br&gt;
### What you type...
&lt;br&gt;
```
# Level 1 heading
## Level 2 heading
### Level 3 heading

```
]
--
.pull-right[
&lt;br&gt;&lt;br&gt;
### What you get...
&lt;br&gt;

## Level 1 heading
### Level 2 heading
#### Level 3 heading
]

---

# Markdown Example

.pull-left[

**Example of a markdown document...**

```
## Introduction





Welcome to my **awesome** class. You 
will learn all kinds of useful things 
about R Markdown.


- Markdown is simple
- You can add R code
```
]

.pull-right[

**Here's what the output looks like...**

## Introduction
&lt;br&gt;
Welcome to my **awesome** class. You will learn 
all kinds of useful things about R Markdown. 

- Markdown is simple
- You can add R code

]

---
class: title-slide, middle

## Exercise

In RStudio Cloud:
- Create a new R Markdown file
- Remove all content except the YAML and save it as "my_first_rmarkdown.rmd"
- Write a sentence about your emotions (positive and negative) triggered by R
- Click "Knit" once finished

<div class="countdown" id="timer_624da436" style="right:0;bottom:0;" data-warnwhen="60">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: title-slide, middle

## The R Code Chunks 

---

# First Code Chunk

In the first code chunk, will be added all the __actions that will be applied to the following chunks__ (e.g., code option, library used, data downloaded, ...).

````markdown

```{r setup, include=FALSE}
# libraries
library(gapminder)
library(knitr)
library(tidyverse)
  
# data
organisation_beta &lt;- read.csv("/cloud/project/organisation_beta.csv")
```

````

Every code chunk starts with 3 back ticks and finishes with 3 back ticks.

The starting back ticks are always followed by a set of {} including the code chunk options

---

# Code Chunk Options

Chunk output can be customized with knitr options (i.e., arguments set in the {} of a chunk header). Above, we use 1 argument:

- `include = FALSE` prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks.


Additional argument will be essential to use as well:

- `echo = FALSE` prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.
- `message = FALSE` prevents messages that are generated by code from appearing in the finished file.
- `warning = FALSE` prevents warnings that are generated by code from appearing in the finished.

See the **[R Markdown Reference Guide](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf)** for a complete list of knitr chunk options.

---

# Figures in the Output Document

As long as the package {tidyverse} is loaded and the data object created in the first setup chunk, then a __ggplot visualisation can be used in a separated chunk__:

````markdown
---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)

organisation_beta &lt;- read.csv("/cloud/project/organisation_beta.csv")
```

# My Section Title

My text followed by my figure.

```{r}
ggplot(organisation_beta) +
  aes(salary, js_score) +
  geom_point()
```
````

---

# Figures in the Output Document

Warning, if the code results in the creation of an object, then the output will not be displayed:


```r
plot_organisation_beta &lt;- ggplot(organisation_beta) +
  aes(salary, js_score) +
  geom_point()
```

To be displayed there are 2 solutions:

#### 1. The content has to be printed by ending the code with the object name


```r
plot_organisation_beta &lt;- ggplot(organisation_beta) +
  aes(salary, js_score) +
  geom_point()

plot_organisation_beta
```

#### 2. The code is ran without creating an object


```r
ggplot(organisation_beta) +
  aes(salary, js_score) +
  geom_point()
```

---

# Chunk Options for Visualisations

In this following example, when the output document is created:

- `echo = TRUE` indicates that not only the output of the code is shown but also the code itself
- `warning = FALSE` indicates that no R warning will be displayed
- `message = FALSE` indicates that no R message will be displayed

````markdown

```{r, echo = TRUE, warning = FALSE, message = FALSE}
ggplot(organisation_beta) +
  aes(salary, js_score) +
  geom_point()
```

````

---

# Visualisation Specific Options

Some chunk options are specific to visualisations outputs:

- fig.cap="caption of the figure"
- fig.height=5
- fig.width=5

Note, the default unit for height and width is inches.

````markdown
```{r, fig.cap="Example Caption", fig.height=2, fig.width=12, message=FALSE}
ggplot(organisation_beta) +
  aes(salary, js_score) +
  geom_point()
```
````

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="chapter_5_files/figure-html/unnamed-chunk-130-1.png" alt="Example Caption" width="864" /&gt;
&lt;p class="caption"&gt;Example Caption&lt;/p&gt;
&lt;/div&gt;

---
class: title-slide, middle

## Live Demo

---
class: inverse, mline, center, middle

# 4. Gallery

---

# Professional websites

&lt;img src="img/example_professional_site.png" width="70%" style="display: block; margin: auto;" /&gt;

---

# Books

&lt;img src="img/example_book.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# Academic papers

&lt;img src="img/example_papers.png" width="60%" style="display: block; margin: auto;" /&gt;

---

# Slide decks

&lt;img src="https://raw.githubusercontent.com/katiejolly/blog/master/assets/slide-design/twitter_img_march.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# CV

&lt;img src="https://kevinrue.github.io/post/writing-my-cv-using-pagedown/featured_hu415bb52acda44839a73c9c4234bb7d44_345471_720x0_resize_lanczos_2.png" width="80%" style="display: block; margin: auto;" /&gt;

---
class: inverse, mline, left, middle

&lt;img class="circle" src="https://github.com/damien-dupre.png" width="250px"/&gt;

# Thanks for your attention and don't hesitate to ask if you have any question!

[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> @damien_dupre](http://twitter.com/damien_dupre)  
[<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> @damien-dupre](http://github.com/damien-dupre)  
[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg> damien-datasci-blog.netlify.app](https://damien-datasci-blog.netlify.app)  
[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg> damien.dupre@dcu.ie](mailto:damien.dupre@dcu.ie)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="libs/cols_macro.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "zenburn",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
